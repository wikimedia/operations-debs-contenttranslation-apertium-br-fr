<?xml version="1.0" encoding="UTF-8"?>
<!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
      <cat-item tags="np.al.*"/> 
    </def-cat>
    <def-cat n="memes">
      <cat-item lemma="memes" tags="adv"/>
      <cat-item lemma="hevelep" tags="adv"/>
    </def-cat>
    <def-cat n="ant">
      <cat-item tags="np.ant"/>
      <cat-item tags="np.ant.*"/>
    </def-cat>
    <def-cat n="loc">
      <cat-item tags="np.loc"/>
      <cat-item tags="np.loc.*"/>
      <cat-item tags="np.top"/>
      <cat-item tags="np.top.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp"/>
      <cat-item tags="vblex.*.pp"/>
      <cat-item tags="adj.pos.*"/>
    </def-cat>
    <def-cat n="verbpart_en_ur">
      <cat-item tags="vpart.ppres"/>
    </def-cat>
    <def-cat n="verbpart_o">
      <cat-item tags="vpart.ger"/>
    </def-cat>
    <def-cat n="verbpart">
      <cat-item tags="vpart"/>
      <cat-item tags="vpart.*"/>
    </def-cat>
    <def-cat n="no">
      <cat-item lemma="no" tags="adv"/>
    </def-cat>
    <def-cat n="re">
      <cat-item lemma="re" tags="prn.ind.*"/>
    </def-cat>
    <def-cat n="netra">
      <cat-item lemma="netra" tags="prn.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vblex.pp"/>
      <cat-item tags="vblex.*.pp"/>
      <cat-item tags="vblex.*.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
    </def-cat>
    <def-cat n="demonstrativo">
      <cat-item lemma="mañ" tags="adv"/>
      <cat-item lemma="se" tags="adv"/>
      <cat-item lemma="hont" tags="adv"/>
    </def-cat>
    <def-cat n="necesitat">
      <cat-item lemma="ret" tags="adj.*"/>
      <cat-item lemma="dav" tags="adj.*"/>
    </def-cat>
    <def-cat n="krog">
      <cat-item lemma="krog" tags="n.m.*"/>
    </def-cat>
    <def-cat n="arabat">
      <cat-item lemma="arabat" tags="adv"/>
    </def-cat>
    <def-cat n="ma">
      <cat-item lemma="ma" tags="cnjsub"/>
    </def-cat>
    <def-cat n="bennak">
      <cat-item lemma="bennak" tags="adj.*"/>
    </def-cat>
    <def-cat n="instant">
      <cat-item lemma="poent" tags="n.m.*"/>
    </def-cat>
    <def-cat n="possibilitat">
      <cat-item lemma="tu" tags="n.m.*"/>
      <cat-item lemma="tro" tags="n.f.*"/>
    </def-cat>
    <def-cat n="eo">
      <cat-item lemma="bezañ" tags="vblex.prh.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.pih.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.cni.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.cip.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.pri.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.fti.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.pii.p3.sg.*"/>
      <cat-item lemma="bezañ" tags="vblex.past.p3.sg.*"/>

      <cat-item lemma="bezañ" tags="vblex.prh.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.pih.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.cni.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.cip.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.pri.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.fti.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.pii.p3.sg"/>
      <cat-item lemma="bezañ" tags="vblex.past.p3.sg"/>
    </def-cat>
    <def-cat n="klask">
      <cat-item lemma="klask" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="bezañ_inf">
      <cat-item lemma="bezañ" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="det_indef">
      <cat-item lemma="un" tags="det.ind.*"/>
    </def-cat>
    <def-cat n="ober_nom">
      <cat-item lemma="ober" tags="n.m.sg"/>
    </def-cat>
    <def-cat n="det">
      <cat-item tags="det.dem.*"/>
      <cat-item tags="det.ind.*"/>
      <cat-item tags="det.def.*"/>
      <cat-item tags="det.pos.*"/>
      <cat-item tags="det.qnt.*"/>
      <cat-item tags="det.itg.*"/>
      <cat-item tags="det.ord.*"/>
      <cat-item tags="predet.*"/>
<!-- <cat-item tags="num.*"/> -->
    </def-cat>
    <def-cat n="percent">
      <cat-item tags="num.percent"/>
    </def-cat>
    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="ord">
      <cat-item tags="num.ord.*"/>
    </def-cat>
    <def-cat n="numeral">
      <cat-item tags="num.*"/>
    </def-cat>
    <def-cat n="cifra">
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="prep">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="a-raok">
      <cat-item lemma="a-raok" tags="pr"/>
    </def-cat>
    <def-cat n="nemet">
      <cat-item lemma="nemet" tags="pr"/>
    </def-cat>
    <def-cat n="ouzhpenn">
      <cat-item lemma="ouzhpenn" tags="pr"/>
    </def-cat>
    <def-cat n="en">
      <cat-item lemma="en" tags="pr"/>
    </def-cat>
    <def-cat n="eus">
      <cat-item lemma="eus" tags="pr"/>
    </def-cat>
    <def-cat n="e">
      <cat-item lemma="e" tags="pr"/>
    </def-cat>
    <def-cat n="all">
      <cat-item lemma="all" tags="adj.ind.*"/>
    </def-cat>
    <def-cat n="ken">
      <cat-item lemma="ken" tags="pr"/>
    </def-cat>
    <def-cat n="a">
      <cat-item lemma="a" tags="pr"/>
    </def-cat>
    <def-cat n="indirect">
      <cat-item lemma="indirect" tags="prn.obj.*"/>
    </def-cat>
    <def-cat n="hon_hor_ho_o">
      <cat-item lemma="hon" tags="det.pos.*"/>
      <cat-item lemma="hor" tags="det.pos.*"/>
      <cat-item lemma="o" tags="det.pos.*"/>
      <cat-item lemma="ho" tags="det.pos.*"/>
    </def-cat>
 
    <def-cat n="prnpos">
<!-- pronoms personals-->
      <cat-item lemma="ma hini" tags="prn.pos.*"/>
      <cat-item lemma="da hini" tags="prn.pos.*"/>
      <cat-item lemma="e hini" tags="prn.pos.*"/>
      <cat-item lemma="he hini" tags="prn.pos.*"/>
      <cat-item lemma="ho hini" tags="prn.pos.*"/>
      <cat-item lemma="hon hini" tags="prn.pos.*"/>
      <cat-item lemma="o hini" tags="prn.pos.*"/>
    </def-cat>
    <def-cat n="prnperssubj">
<!-- pronoms personals-->
      <cat-item lemma="prpers" tags="prn.*"/>
      <cat-item lemma="me" tags="prn.*"/>
      <cat-item lemma="te" tags="prn.*"/>
      <cat-item lemma="eñ" tags="prn.*"/>
      <cat-item lemma="hi" tags="prn.*"/>
      <cat-item lemma="ni" tags="prn.*"/>
      <cat-item lemma="c’hwi" tags="prn.*"/>
      <cat-item lemma="int" tags="prn.*"/>
    </def-cat>
    <def-cat n="direct">
      <cat-item lemma="direct" tags="prn.obj.*"/>
    </def-cat>
    <def-cat n="prnsubj">
      <!-- prn no personals que poden ser subjecte-->
      <cat-item tags="prn.ind.*"/>
      <cat-item tags="prn.tn.*"/>
      <cat-item tags="prn.pos.*"/>
      <cat-item tags="prn.dem.*"/>
      <cat-item lemma="pep tra" tags="prn.def.*"/>
    </def-cat>
    <def-cat n="prnref">
      <cat-item tags="prn.ref.*"/>
    </def-cat>
    <def-cat n="prnitg">
      <cat-item tags="prn.itg.*"/>
    </def-cat>
    <def-cat n="rel">
      <cat-item tags="prn.rel.*"/>
      <cat-item tags="rel.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="rankout">
      <cat-item lemma="rankout" tags="vblex.prs.*"/>
      <cat-item lemma="rankout" tags="vblex.pri.*"/>
      <cat-item lemma="rankout" tags="vblex.fts.*"/>
      <cat-item lemma="rankout" tags="vblex.pis.*"/>
      <cat-item lemma="rankout" tags="vblex.pii.*"/>
      <cat-item lemma="rankout" tags="vblex.ifi.*"/>
      <cat-item lemma="rankout" tags="vblex.imp.*"/>
      <cat-item lemma="rankout" tags="vblex.fti.*"/>
      <cat-item lemma="rankout" tags="vblex.cni.*"/>
      <cat-item lemma="rankout" tags="vblex.cip.*"/>
    </def-cat>

    <def-cat n="mont">
      <cat-item lemma="mont a ober" tags="vblex.prs.*"/>
      <cat-item lemma="mont a ober" tags="vblex.pri.*"/>
      <cat-item lemma="mont a ober" tags="vblex.fts.*"/>
      <cat-item lemma="mont a ober" tags="vblex.pis.*"/>
      <cat-item lemma="mont a ober" tags="vblex.pii.*"/>
      <cat-item lemma="mont a ober" tags="vblex.ifi.*"/>
      <cat-item lemma="mont a ober" tags="vblex.imp.*"/>
      <cat-item lemma="mont a ober" tags="vblex.fti.*"/>
      <cat-item lemma="mont a ober" tags="vblex.cni.*"/>
      <cat-item lemma="mont a ober" tags="vblex.cip.*"/>
      <cat-item lemma="mont" tags="vblex.prs.*"/>
      <cat-item lemma="mont" tags="vblex.pri.*"/>
      <cat-item lemma="mont" tags="vblex.fts.*"/>
      <cat-item lemma="mont" tags="vblex.pis.*"/>
      <cat-item lemma="mont" tags="vblex.pii.*"/>
      <cat-item lemma="mont" tags="vblex.ifi.*"/>
      <cat-item lemma="mont" tags="vblex.imp.*"/>
      <cat-item lemma="mont" tags="vblex.fti.*"/>
      <cat-item lemma="mont" tags="vblex.cni.*"/>
      <cat-item lemma="mont" tags="vblex.cip.*"/>
    </def-cat>
    <def-cat n="mont_inf">
      <cat-item lemma="mont" tags="vblex.inf"/>
    </def-cat>
    <def-cat n="fellout_inf">
      <cat-item lemma="fellout" tags="vblex.inf"/>
    </def-cat>

    <def-cat n="aux">
      <cat-item lemma="kaout" tags="vblex.prs.*"/>
      <cat-item lemma="kaout" tags="vblex.pri.*"/>
      <cat-item lemma="kaout" tags="vblex.fts.*"/>
      <cat-item lemma="kaout" tags="vblex.pis.*"/>
      <cat-item lemma="kaout" tags="vblex.pii.*"/>
      <cat-item lemma="kaout" tags="vblex.ifi.*"/>
      <cat-item lemma="kaout" tags="vblex.fti.*"/>
      <cat-item lemma="kaout" tags="vblex.cni.*"/>
      <cat-item lemma="kaout" tags="vblex.cip.*"/>

      <cat-item tags="vbloc.*"/>

      <cat-item lemma="bezañ" tags="vblex.prs.*"/>
      <cat-item lemma="bezañ" tags="vblex.fts.*"/>
      <cat-item lemma="bezañ" tags="vblex.pis.*"/>
      <cat-item lemma="bezañ" tags="vblex.pii.*"/>
      <cat-item lemma="bezañ" tags="vblex.ifi.*"/>
      <cat-item lemma="bezañ" tags="vblex.fti.*"/>
      <cat-item lemma="bezañ" tags="vblex.cni.*"/>
      <cat-item lemma="bezañ" tags="vblex.cip.*"/>
      <cat-item lemma="bezañ" tags="vblex.pri.*"/>
    </def-cat>
 
    <def-cat n="fellout">
      <cat-item lemma="fellout" tags="vblex.prs.*"/>
      <cat-item lemma="fellout" tags="vblex.fts.*"/>
      <cat-item lemma="fellout" tags="vblex.pis.*"/>
      <cat-item lemma="fellout" tags="vblex.pii.*"/>
      <cat-item lemma="fellout" tags="vblex.ifi.*"/>
      <cat-item lemma="fellout" tags="vblex.imp.*"/>
      <cat-item lemma="fellout" tags="vblex.fti.*"/>
      <cat-item lemma="fellout" tags="vblex.past.*"/>
      <cat-item lemma="fellout" tags="vblex.cni.*"/>
      <cat-item lemma="fellout" tags="vblex.cip.*"/>
      <cat-item lemma="fellout" tags="vblex.pri.*"/>
    </def-cat>
    <def-cat n="bezañ">
      <cat-item tags="vbloc.*"/>

      <cat-item lemma="bezañ" tags="vblex.prs.*"/>
      <cat-item lemma="bezañ" tags="vblex.fts.*"/>
      <cat-item lemma="bezañ" tags="vblex.pis.*"/>
      <cat-item lemma="bezañ" tags="vblex.pii.*"/>
      <cat-item lemma="bezañ" tags="vblex.ifi.*"/>
      <cat-item lemma="bezañ" tags="vblex.fti.*"/>
      <cat-item lemma="bezañ" tags="vblex.cni.*"/>
      <cat-item lemma="bezañ" tags="vblex.cip.*"/>
      <cat-item lemma="bezañ" tags="vblex.pri.*"/>
    </def-cat>
    <def-cat n="ober">
      <cat-item lemma="ober" tags="vblex.*"/>
    </def-cat>
    <def-cat n="verbm">
<!--verb modal -->
      <cat-item tags="vbmod.*"/>
    </def-cat>
    
    <def-cat n="verbimp">
      <cat-item lemma="kaout" tags="vblex.imp.*"/>
      <cat-item lemma="bezañ" tags="vblex.imp.*"/>
      <cat-item lemma="bezañ" tags="vblex.imp.*"/>
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vblex.*.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbloc.imp.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vblex.pron.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
    </def-cat>
    <def-cat n="verbpers">
      <cat-item tags="vblex.*.cip.*"/>
      <cat-item tags="vblex.*.cni.*"/>
      <cat-item tags="vblex.*.fti.*"/>
      <cat-item tags="vblex.*.ifi.*"/>
      <cat-item tags="vblex.*.past.*"/>
      <cat-item tags="vblex.*.pii.*"/>
      <cat-item tags="vblex.*.pis.*"/>
      <cat-item tags="vblex.*.pri.*"/>
      <cat-item tags="vblex.*.prs.*"/>
      <cat-item tags="vblex.*.prh.*"/>
      <cat-item tags="vblex.*.pih.*"/>
      <cat-item tags="vblex.*.fts.*"/>
      <cat-item tags="vblex.cip.*"/>
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vblex.past.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vblex.prh.*"/>
      <cat-item tags="vblex.pih.*"/>
      <cat-item tags="vblex.fts.*"/>
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbser.prh.*"/>
      <cat-item tags="vbser.pih.*"/>
      <cat-item tags="vbser.fts.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.past.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
      <cat-item tags="vbhaver.prh.*"/>
      <cat-item tags="vbhaver.pih.*"/>
      <cat-item tags="vbhaver.fts.*"/>

      <cat-item tags="vbloc.cni.*"/>
      <cat-item tags="vbloc.fti.*"/>
      <cat-item tags="vbloc.ifi.*"/>
      <cat-item tags="vbloc.past.*"/>
      <cat-item tags="vbloc.pii.*"/>
      <cat-item tags="vbloc.pis.*"/>
      <cat-item tags="vbloc.pri.*"/>
      <cat-item tags="vbloc.prs.*"/>
      <cat-item tags="vbloc.prh.*"/>
      <cat-item tags="vbloc.pih.*"/>
      <cat-item tags="vbloc.fts.*"/>

      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.ifi.*"/>
      <cat-item tags="vbmod.past.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vbmod.prh.*"/>
      <cat-item tags="vbmod.pih.*"/>
      <cat-item tags="vbmod.fts.*"/>
      <cat-item tags="vblex.pron.cni.*"/>
      <cat-item tags="vblex.pron.fti.*"/>
      <cat-item tags="vblex.pron.ifi.*"/>
      <cat-item tags="vblex.past.imp.*"/>
      <cat-item tags="vblex.pron.pii.*"/>
      <cat-item tags="vblex.pron.pis.*"/>
      <cat-item tags="vblex.pron.pri.*"/>
      <cat-item tags="vblex.pron.prs.*"/>
    </def-cat>
    <def-cat n="auxpers">
      <cat-item tags="vbser.cni.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbser.past.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbhaver.cni.*"/>
      <cat-item tags="vbhaver.fti.*"/>
      <cat-item tags="vbhaver.ifi.*"/>
      <cat-item tags="vbhaver.past.*"/>
      <cat-item tags="vbhaver.pii.*"/>
      <cat-item tags="vbhaver.pis.*"/>
      <cat-item tags="vbhaver.pri.*"/>
      <cat-item tags="vbhaver.prs.*"/>
    </def-cat>
    <def-cat n="pp">
      <cat-item tags="vblex.*.pp"/>
      <cat-item tags="vblex.*.pp.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vblex.pp"/>
      <cat-item tags="vbser.pp"/>
      <cat-item tags="vbmod.pp"/>
      <cat-item tags="vbhaver.pp"/>
<!--ATENCI? CANVI -->
    </def-cat>
    <def-cat n="inf">
      <cat-item tags="vblex.*.inf"/>

      <cat-item tags="vblex.inf"/>
      <cat-item tags="vblex.pron.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbmod.inf"/>
    </def-cat>
    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="adv_neg">
      <cat-item tags="adv"/>
      <cat-item tags="adv.neg"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="advitg">
      <cat-item tags="adv.itg"/>
    </def-cat>
    <def-cat n="ne">
      <cat-item lemma="ne" tags="adv"/>
      <cat-item lemma="ne" tags="vpart.neg"/>
      <cat-item lemma="na" tags="vpart.neg"/>
    </def-cat>
    <def-cat n="cnjcoo">
      <cat-item lemma="ha" tags="cnjcoo"/>
    </def-cat>
    <def-cat n="cnj">
      <cat-item tags="cnjcoo"/>
      <cat-item tags="cnjsub"/>
      <cat-item tags="cnjadv"/>
    </def-cat>

    <!-- Categorias lexicalizadas -->
    <def-cat n="da">
      <cat-item lemma="da" tags="pr"/>
    </def-cat>
    <def-cat n="de">
      <cat-item lemma="de" tags="pr"/>
    </def-cat>
    <def-cat n="gwezh">
      <cat-item lemma="gwezh" tags="n.f.*"/>
      <cat-item lemma="gwech" tags="n.f.*"/>
    </def-cat>

    <def-cat n="temp_nom">
      <cat-item lemma="deiz" tags="n.m.*"/>
      <cat-item lemma="noz" tags="n.f.*"/>
      <cat-item lemma="sizhun" tags="n.f.*"/>
      <cat-item lemma="miz" tags="n.m.*"/>
      <cat-item lemma="bloaz" tags="n.m.*"/>
    </def-cat>

    <!-- Punctuation -->
    <def-cat n="sent">
      <cat-item tags="sent"/>
    </def-cat>
    <def-cat n="coma">
      <cat-item tags="cm"/>
    </def-cat>
    <def-cat n="guio">
      <cat-item tags="guio"/>
    </def-cat>
  </section-def-cats>


  <section-def-attrs>
    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="n.unc"/>
      <attr-item tags="np.loc"/>
      <attr-item tags="np.top"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.al"/>
    </def-attr>
    <def-attr n="a_np_acr">
      <attr-item tags="np"/>
      <attr-item tags="acr"/>
    </def-attr>
    <def-attr n="grau_adj">
      <attr-item tags="comp"/>
      <attr-item tags="sup"/>

    </def-attr>
    <def-attr n="a_adj">
      <attr-item tags="adj"/>
<!--      <attr-item tags="adj.sint"/>
      <attr-item tags="adj.sint.comp"/>
      <attr-item tags="adj.sint.sup"/> -->
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.ind"/>
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vbhaver.pp"/>
      <attr-item tags="vbser.pp"/>
    </def-attr>
    <def-attr n="a_det">
      <attr-item tags="det.dem"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.def"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="det.qnt"/>
      <attr-item tags="det.itg"/>
      <attr-item tags="det.ord"/>
      <attr-item tags="predet"/>
      <attr-item tags="num"/>
    </def-attr>
    <def-attr n="a_num">
      <attr-item tags="num"/>
      <attr-item tags="num.percent"/>
      <attr-item tags="num.ord"/>
    </def-attr>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>
    <def-attr n="pron">
      <attr-item tags="pron"/>
    </def-attr>
    <def-attr n="sep">
      <attr-item tags="sep"/>
    </def-attr>
    <def-attr n="a_part">
      <attr-item tags="obj"/>
      <attr-item tags="subj"/>
      <attr-item tags="opt"/>
      <attr-item tags="neg"/>
      <attr-item tags="ger"/>
      <attr-item tags="ppres"/>
      <attr-item tags="ref"/>
    </def-attr>
    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
      <attr-item tags="adv.itg"/>
    </def-attr>
    <def-attr n="a_pp">
      <attr-item tags="vblex.pp"/>
      <attr-item tags="vbser.pp"/>
      <attr-item tags="vbmod.pp"/>
      <attr-item tags="vblex.sep.pp"/>
      <attr-item tags="vbser.sep.pp"/>
      <attr-item tags="vbmod.sep.pp"/>
      <attr-item tags="vaux.pp"/>
      <attr-item tags="vbhaver.pp"/>
    </def-attr>
    <def-attr n="a_prn">
      <attr-item tags="prn"/>
<!--      <attr-item tags="prn.ind"/> -->
    </def-attr>
    <def-attr n="transitivitat">
      <attr-item tags="tv"/>
      <attr-item tags="iv"/>
    </def-attr>
    <def-attr n="a_rel">
      <attr-item tags="rel"/>
      <attr-item tags="rel.adv"/>
    </def-attr>
    <def-attr n="tipus_prn">
      <attr-item tags="subj"/>
      <attr-item tags="rel"/>
      <attr-item tags="rel.adv"/>
      <attr-item tags="rel.nn"/>
      <attr-item tags="obj"/>
      <attr-item tags="ind"/>
      <attr-item tags="ref"/>
      <attr-item tags="tn"/>
      <attr-item tags="tn.ref"/>
      <attr-item tags="itg"/>
      <attr-item tags="pos"/>
    </def-attr>
    <def-attr n="tipoenc_pro">
      <attr-item tags="ref.p3.mf.sp"/>
      <attr-item tags="p1.mf.pl"/>
      <attr-item tags="p1.mf.sg"/>
      <attr-item tags="p2.mf.pl"/>
      <attr-item tags="p2.mf.sg"/>
      <attr-item tags="p3.f.pl"/>
      <attr-item tags="p3.f.sg"/>
      <attr-item tags="p3.mf.pl"/>
      <attr-item tags="p3.mf.sg"/>
      <attr-item tags="p3.m.pl"/>
      <attr-item tags="p3.m.sg"/>
      <attr-item tags="p3.nt"/>
      <attr-item tags="mf.sg"/>
      <attr-item tags="adv"/>
    </def-attr>
    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="impers"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>
    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="nt"/>
      <attr-item tags="GD"/>
    </def-attr>
    <def-attr n="gen_sense_mf">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>
    <def-attr n="gen_mf">
      <attr-item tags="mf"/>
    </def-attr>
    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="nbr_sense_sp">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="ND"/>
    </def-attr>
    <def-attr n="nbr_sp">
      <attr-item tags="sp"/>
    </def-attr>
    <def-attr n="temps">
      <attr-item tags="cip"/>
      <attr-item tags="cni"/>
      <attr-item tags="fts"/>
      <attr-item tags="fti"/>
      <attr-item tags="ifi"/>
      <attr-item tags="imp"/>
      <attr-item tags="pii"/>
      <attr-item tags="pis"/>
      <attr-item tags="pri"/>
      <attr-item tags="prs"/>
      <attr-item tags="prh"/>
      <attr-item tags="pih"/>
      <attr-item tags="past"/>
      <attr-item tags="pp"/>
<!-- ? -->
      <attr-item tags="ger"/>
<!-- ? -->
      <attr-item tags="inf"/>
<!-- ? -->
    </def-attr>
    <def-attr n="neg">
      <attr-item tags="NEG"/>
    </def-attr>
    <def-attr n="syn_label">
      <attr-item tags="@X"/>
      <attr-item tags="@←SUBJ"/>
      <attr-item tags="@SUBJ→"/>
      <attr-item tags="@\+FMAINV"/>
      <attr-item tags="@-FMAINV"/>
    </def-attr>
  </section-def-attrs>
  <section-def-vars>
    <def-var n="cur_espai"/>
    <def-var n="debug"/>
    <def-var n="treu_ref"/>
    <def-var n="nbr_pp"/>
    <def-var n="cur_syn_label"/>
    <def-var n="gen_pp"/>
    <def-var n="etiq_aux"/>
    <def-var n="etiq_det"/>
    <def-var n="concorden"/>
    <def-var n="numero" v="&lt;sg&gt;"/>
    <def-var n="genero" v="&lt;m&gt;"/>
    <def-var n="concDet"/>
    <def-var n="concAdj"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="adjectiu1"/>
    <def-var n="adjectiu2"/>
    <def-var n="interrogativa"/>
    <def-var n="exclamativa"/>
    <def-var n="caseFirstWord"/>
    <def-var n="lema"/>
    <def-var n="lema_Vpart"/>
    <def-var n="lema_Prep"/>
    <def-var n="lu_Prep"/>
    <def-var n="lu_Adj1"/>
    <def-var n="lu_Adj2"/>
    <def-var n="EOS" v="true"/>
    <def-var n="paraula1"/>
    <def-var n="SVnegatiu"/>
    <def-var n="auxiliar"/>
    <def-var n="art_np"/>
    <def-var n="art1"/>
  </section-def-vars>
  <section-def-lists>


   <def-list n="vbpron">
      <list-item v="salir# del paso"/>
   </def-list>

    <!-- Verbs que són reflexius quan siguen intransitius en bretó / verboù emober e galleg hepken pa vez un implij gwan e brezhoneg -->
    <def-list n="verbref_iv_meta">
	<list-item v="brañsellat"/>
	<list-item v="brañskellat"/>
	<list-item v="digoumanantiñ"/>
	<list-item v="koumanantiñ"/>
    <list-item v="sevel"/>
    </def-list>
 
    <!-- Verbs que no són reflexius en bretó però si que són en francès / verboù emober e galleg met ket e brezhoneg -->
    <def-list n="verbref_meta">
      <list-item v="approprier"/>
      <list-item v="arrêter"/>
      <list-item v="asseoir"/>
      <list-item v="baigner"/>
      <list-item v="balancer"/>
      <list-item v="baser# sur"/>
      <list-item v="connecter# à"/>
      <list-item v="ébattre"/>
      <list-item v="efforcer"/>
      <list-item v="enorgueillir"/>
      <list-item v="évanouir"/>
      <list-item v="faire# un nom"/>
      <list-item v="former# en étang"/>
      <list-item v="fouler"/>
      <list-item v="garer"/>
      <list-item v="masturber"/>
      <list-item v="mettre# en colère"/>
      <list-item v="mettre# en relation"/>
      <list-item v="occuper# de"/>
      <list-item v="passer# de"/>
      <list-item v="plaindre"/>
      <list-item v="plaire"/>
      <list-item v="porter# candidat"/>
      <list-item v="réapproprier"/>
      <list-item v="rendre# compte"/>
      <list-item v="reposer"/>
      <list-item v="pavaner"/>
      <list-item v="souvenir"/>
      <list-item v="tromper"/>
	  <list-item v="vanter"/>
    </def-list>

    <!-- Verboù a zispleger dre être e galleg -->	
    <def-list n="vbambser">
      <list-item v="accourir"/>
      <list-item v="advenir"/>
      <list-item v="affliger"/>
      <list-item v="aller"/>
      <list-item v="allonger"/>
      <list-item v="apparaître"/>
      <list-item v="arriver"/>
      <list-item v="cacher"/>
      <list-item v="connaître"/>
      <list-item v="décéder"/>
      <list-item v="descendre"/>
      <list-item v="développer"/>
      <list-item v="devenir"/>
      <list-item v="entrer"/>
      <list-item v="établir"/>
      <list-item v="étendre"/>
      <list-item v="imposer"/>
      <list-item v="intervenir"/>
      <list-item v="inviter"/>	  
      <list-item v="monter"/>
      <list-item v="mourir"/>
      <list-item v="naître"/>
      <list-item v="partir"/>
      <list-item v="parvenir"/>
      <list-item v="passer"/>
      <list-item v="préoccuper"/>
      <list-item v="rassasier"/>
      <list-item v="reconnaître"/>
      <list-item v="redescendre"/>
      <list-item v="remonter"/>
      <list-item v="rentrer"/>
      <list-item v="repartir"/>
      <list-item v="ressortir"/>
      <list-item v="rester"/>
      <list-item v="retomber"/>
      <list-item v="revenir"/>
      <list-item v="sortir"/>
      <list-item v="tomber"/>
      <list-item v="tomber# amoureux"/>
      <list-item v="venir"/>
	  </def-list>
    <def-list n="dias">
      <list-item v="Lun"/>
      <list-item v="Merc’her"/>
      <list-item v="Meurzh"/>
      <list-item v="Sul"/>
      <list-item v="Yaou"/>
      <list-item v="Gwener"/>
      <list-item v="Sadorn"/>
    </def-list>
    <def-list n="substances">
      <list-item v="aluminiom"/>
      <list-item v="amann"/>
      <list-item v="aour"/>
      <list-item v="arc’hant"/>
      <list-item v="arem"/>
      <list-item v="argant"/>
      <list-item v="bara"/>
      <list-item v="bleud"/>
      <list-item v="dir"/>
      <list-item v="eoul"/>
      <list-item v="fred"/>
      <list-item v="greunit"/>
      <list-item v="holen"/>
      <list-item v="houarn"/>
      <list-item v="koad"/>
      <list-item v="koar"/>
      <list-item v="metal"/>
      <list-item v="neud"/>
      <list-item v="paper"/>
      <list-item v="pebr"/>
      <list-item v="plom"/>
      <list-item v="sklent"/>
      <list-item v="sukr"/>
	  </def-list>
    <def-list n="meses">
      <list-item v="Genver"/>
      <list-item v="C’hwevrer"/>
      <list-item v="Meurzh"/>
      <list-item v="Ebrel"/>
      <list-item v="Mae"/>
      <list-item v="Mezheven"/>
      <list-item v="Gouere"/>
      <list-item v="Gouhere"/>
      <list-item v="Eost"/>
      <list-item v="Gwengolo"/>
      <list-item v="Here"/>
      <list-item v="Du"/>
      <list-item v="Even"/>
      <list-item v="Kerzu"/>
      <list-item v="miz Genver"/>
      <list-item v="miz C’hwevrer"/>
      <list-item v="miz Meurzh"/>
      <list-item v="miz Ebrel"/>
      <list-item v="miz Mae"/>
      <list-item v="miz Mezheven"/>
      <list-item v="miz Gouere"/>
      <list-item v="miz Gouhere"/>
      <list-item v="miz Eost"/>
      <list-item v="miz Gwengolo"/>
      <list-item v="miz Here"/>
      <list-item v="miz Even"/>
      <list-item v="miz Du"/>
      <list-item v="miz Kerzu"/>
    </def-list>
    <def-list n="advneg">
      <list-item v="pas"/>
      <list-item v="jamais"/>
    </def-list>
    <def-list n="advmod">
	<list-item v="ac’hub"/>
	<list-item v="a-walc’h"/>
      <list-item v="bras"/>
      <list-item v="espar"/>
      <list-item v="eston"/>
      <list-item v="fin"/>
      <list-item v="kenañ"/>
      <list-item v="ken-ha-ken"/>
      <list-item v="klok"/>	
      <list-item v="krak"/>		  
      <list-item v="lip"/>	  
      <list-item v="mat"/>
      <list-item v="mik"/>
      <list-item v="poch"/>	
      <list-item v="rik"/>	  
      <list-item v="tre"/>
	  </def-list>

    <def-list n="part_sing">

      <list-item v="alcool"/>	
      <list-item v="argent"/>	
      <list-item v="beurre"/>
      <list-item v="bière"/>
      <list-item v="café"/>
      <list-item v="chance"/>
      <list-item v="chanvre"/>
      <list-item v="chouchenn"/>
      <list-item v="cire"/>
      <list-item v="eau"/>
      <list-item v="farine"/>
      <list-item v="genêt"/>
      <list-item v="herbe"/>
      <list-item v="huile"/>
      <list-item v="lambig"/>
      <list-item v="lessive"/>
      <list-item v="limonade"/>
      <list-item v="marbre"/>
      <list-item v="or"/>	  
      <list-item v="pain"/>
      <list-item v="plaisir"/>
      <list-item v="poivre"/>
      <list-item v="sel"/>
      <list-item v="sucre"/>
      <list-item v="tabac"/>	 
      <list-item v="thé"/>	  
      <list-item v="vanille"/>
      <list-item v="viande"/>
      <list-item v="vin"/>
      <list-item v="vinaigre"/>

      <list-item v="travail"/>
   </def-list>
   <def-list n="nom_indef_paire">
      <list-item v="botez"/>
      <list-item v="lunedoù"/>
      <list-item v="maneg"/>
    </def-list>
    <def-list n="npf">
      <list-item v="Afrique"/>
      <list-item v="Afrique du Sud"/>
      <list-item v="Algérie"/>
      <list-item v="Allemagne"/>
      <list-item v="Alsace"/>
      <list-item v="Amérique"/>
      <list-item v="Andalousie"/>
      <list-item v="Andorre"/>
      <list-item v="Angleterre"/> 
      <list-item v="Arabie"/>
      <list-item v="Argentine"/>
      <list-item v="Asie"/>
      <list-item v="Australie"/>
      <list-item v="Autriche"/>
      <list-item v="Autriche-Hongrie"/>
      <list-item v="Belgique"/>
      <list-item v="Biscaye"/>
      <list-item v="Biélorussie"/>
      <list-item v="Bolivie"/>
      <list-item v="Bosnie"/>
      <list-item v="Bretagne"/>  
      <list-item v="Basse-Bretagne"/>  
      <list-item v="Haute-Bretagne"/>  
      <list-item v="Bulgarie"/>
      <list-item v="Cantabrie"/>
      <list-item v="Caraïbe"/>
      <list-item v="Catalogne"/>
      <list-item v="Chine"/>
      <list-item v="Colombie"/>
      <list-item v="Corée"/>
      <list-item v="Cornouaille"/>
      <list-item v="Corse"/>
      <list-item v="Croatie"/>
      <list-item v="Corse"/>
      <list-item v="Égypte"/>
      <list-item v="Espagne"/>
      <list-item v="Estonie"/>
      <list-item v="Europe"/>
      <list-item v="Estrémadure"/>
      <list-item v="Éthiopie"/>
      <list-item v="Finlande"/>
      <list-item v="France"/> 
      <list-item v="Galice"/>
      <list-item v="Grande-Bretagne"/>
      <list-item v="Grenade"/>
      <list-item v="Grèce"/>
      <list-item v="Guadeloupe"/>
      <list-item v="Guinée"/>
      <list-item v="Guyane"/>
      <list-item v="Guyane Française"/>
      <list-item v="Hollande"/>
      <list-item v="Hongrie"/>
      <list-item v="Inde"/>
      <list-item v="Indonésie"/>
      <list-item v="Irlande"/> 
      <list-item v="Islande"/>
      <list-item v="Italie"/>
      <list-item v="Jamaïque"/>
      <list-item v="Jordanie"/>
      <list-item v="Libye"/>
      <list-item v="Lituanie"/>
      <list-item v="Lorraine"/>
      <list-item v="Malte"/>
      <list-item v="Martinique"/>
      <list-item v="Navarre"/>
      <list-item v="Norvège"/>
      <list-item v="Nouvelle-Zélande"/>
      <list-item v="Palestine"/>
      <list-item v="Pennsylvanie"/>
      <list-item v="Pologne"/>
      <list-item v="Rioja"/>
      <list-item v="Roumanie"/>
      <list-item v="Russie"/>
      <list-item v="Serbie"/>
      <list-item v="Slovaquie"/>
      <list-item v="Slovénie"/>
      <list-item v="Somalie"/>
      <list-item v="Suisse"/>
      <list-item v="Suède"/>
      <list-item v="Syrie"/>
      <list-item v="Tanzanie"/>
      <list-item v="Tchétchénie"/>
      <list-item v="Thaïlande"/>
      <list-item v="Tunisie"/>
      <list-item v="Turquie"/>
      <list-item v="Ukraine"/>
      <list-item v="Union Européenne"/>
      <list-item v="Yougoslavie"/>
      <list-item v="Zélande"/>
    </def-list>
    <def-list n="npm">
      <list-item v="Afghanistan"/>
      <list-item v="Alger"/>
      <list-item v="Amsterdam"/>
      <list-item v="Atlantique"/>
      <list-item v="Atlas"/>
      <list-item v="Bangladesh"/>
      <list-item v="Bernabéu"/>
      <list-item v="Brésil"/>
      <list-item v="Cameroun"/>
      <list-item v="Canada"/>
      <list-item v="Caucase"/>
      <list-item v="Chili"/>
      <list-item v="Congo"/>
      <list-item v="Danemark"/>
      <list-item v="Elysée"/>
      <list-item v="Etna"/>
      <list-item v="Gabon"/>
      <list-item v="Goëlo"/>
      <list-item v="Guatemala"/>
      <list-item v="Gujarat"/>
      <list-item v="Irak"/>
      <list-item v="Iran"/>
      <list-item v="Japon"/>
      <list-item v="Kenya"/>
      <list-item v="Koweït"/>
      <list-item v="Kurdistan"/>
      <list-item v="Leon"/>
      <list-item v="Léon"/>	  
      <list-item v="Liban"/>
      <list-item v="Luxembourg"/>
      <list-item v="Maghreb"/>
      <list-item v="Mali"/>
      <list-item v="Mexique"/>
      <list-item v="Monténégro"/>
      <list-item v="Nicaragua"/>
      <list-item v="Niger"/>
      <list-item v="Nigeria"/>
      <list-item v="Népal"/>
      <list-item v="Ouganda"/>
      <list-item v="Pakistan"/>
      <list-item v="Panama"/>
      <list-item v="Panamá"/>
      <list-item v="Paraguay"/>
      <list-item v="Pays Basque"/>
      <list-item v="Pays de Galles"/>
      <list-item v="Portugal"/>
      <list-item v="Pérou"/>
      <list-item v="Qatar"/>
      <list-item v="Royaume-Uni"/>
      <list-item v="Rwanda"/>
      <list-item v="Soudan"/>
      <list-item v="Sénégal"/>
      <list-item v="Stromboli"/>
      <list-item v="Tchad"/>
      <list-item v="Uruguay"/>
      <list-item v="Vatican"/>
      <list-item v="Venezuela"/>
      <list-item v="Viêt nam"/>
      <list-item v="Équateur"/>
      <list-item v="Trégor"/>
    </def-list>
    <def-list n="nppl">
      <list-item v="Açores"/>
      <list-item v="Antilles"/>
      <list-item v="Alpes"/>
      <list-item v="Andes"/>
      <list-item v="Alpes-Maritimes"/>
      <list-item v="Amériques"/>
      <list-item v="Asturies"/>
      <list-item v="Baléares"/>
      <list-item v="Canaries"/>
      <list-item v="Côtes-d’Armor"/>	
      <list-item v="Côtes-du-Nord"/>		  
      <list-item v="États-Unis"/>
      <list-item v="EE.UU."/>
      <list-item v="Philippines"/>
      <list-item v="Pyrénées"/>
      <list-item v="Pyrénées-Atlantiques"/>
      <list-item v="USA"/>
	  </def-list>
     <def-list n="menezioù">
      <list-item v="Alpoù"/>
      <list-item v="Pireneoù"/>
      <list-item v="Menezioù Roc’hellek"/>
      <list-item v="Andoù"/>
    </def-list>
    <def-list n="broioùbreizh">
	  <list-item v="bro-Bentevr"/>
	  <list-item v="bro-Borc’hoed"/>
	  <list-item v="bro-Dinan"/>
      <list-item v="bro-Dreger"/>
      <list-item v="bro-Gemper"/>
      <list-item v="bro-Gemperle"/>
      <list-item v="bro-Gerne"/>
      <list-item v="bro-Gernev"/>
      <list-item v="bro-Gwened"/>
      <list-item v="bro-Leon"/>
      <list-item v="bro-Naoned"/>
      <list-item v="bro-Oueloù"/>	  
      <list-item v="bro-Pourlet"/>
      <list-item v="bro-Roazhon"/>
      <list-item v="bro-Sant-Brieg"/>
      <list-item v="bro-Sant-Maloù"/>
      <list-item v="bro-Vigoudenn"/>
      <list-item v="bro-Vrest"/>
      <list-item v="bro-Wened"/>
      <list-item v="bro-Zol"/>
    </def-list>
    <def-list n="adv_colloc_abans">
      <list-item v="assez"/>
      <list-item v="très"/>
      <list-item v="particulièrement"/>
    </def-list>
    <def-list n="adj_colloc_abans">
      <list-item v="autre"/>
      <list-item v="beau"/>
      <list-item v="bon"/>
      <list-item v="dernier"/>
      <list-item v="deuxième"/>
      <list-item v="grand"/>
      <list-item v="gros"/>
      <list-item v="jeune"/>
      <list-item v="joli"/>
      <list-item v="lourd"/>
      <list-item v="mauvais"/>
      <list-item v="meilleur"/>
      <list-item v="moindre"/>
      <list-item v="nouveau"/>
      <list-item v="petit"/>
      <list-item v="pire"/>
      <list-item v="premier"/>  
      <list-item v="second"/>
      <list-item v="vieux"/>
      <list-item v="vrai"/>
	  </def-list>
  </section-def-lists>
  <section-def-macros>
    <def-macro n="set_syn_label" npar="1">
        <choose>
          <when>
            <test> 
              <equal>
                <clip pos="1" side="sl" part="syn_label"/>
                <lit v=""/>
              </equal>
             </test>
            <let>
              <var n="cur_syn_label"/>
              <lit-tag v="@X"/>
            </let>
          </when>
          <otherwise>
            <let> 
              <var n="cur_syn_label"/>
              <clip pos="1" side="sl" part="syn_label"/>
            </let>
          </otherwise>
        </choose>
    </def-macro>
    <def-macro n="prn_pos_to_det_pos" npar="1">
      <choose>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le mien"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="mon"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le tien"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="ton"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le sien"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="son"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le nôtre"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="notre"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
        </when>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le vôtre"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="votre"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
        </when>
        <when>
          <test> 
              <equal caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <lit v="le leur"/>
              </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="leur"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="mf"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="indirect_to_prnpers" npar="1">
      <choose>

        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="sl" part="pers"/>
                <lit-tag v="p1"/>
              </equal>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="je"/>
              <lit-tag v="prn.tn.p1.mf.sg"/>
            </concat>
          </let>
        </when> 


        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test> 
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="m"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="whole"/>
                <concat>
                  <lit v="il"/>
                  <lit-tag v="prn.tn.p3.m.sg"/>
                </concat>
              </let>
            </when>
            <when>
              <test>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="whole"/>
                <concat>
                  <lit v="il"/>
                  <lit-tag v="prn.tn.p3.f.sg"/>
                </concat>
              </let>
            </when>
    
          </choose>
        </when> 

        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p1"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="nous"/>
              <lit-tag v="prn.tn.p1.mf.pl"/>
            </concat>
          </let>
        </when> 

        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p2"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="tu"/>
              <lit-tag v="prn.tn.p2.mf.sg"/>
            </concat>
          </let>
        </when> 

        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p2"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="vous"/>
              <lit-tag v="prn.tn.p2.mf.pl"/>
            </concat>
          </let>
        </when> 

        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.pl"/>
            </concat>
          </let>
        </when> 

      </choose>
    </def-macro>

    <def-macro n="indirect_to_proclitic" npar="1">
      <choose>
        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p2"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="te"/>
              <lit-tag v="prn.pro.p2.mf.sg"/>
            </concat>
          </let>
        </when> 
        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="leur"/>
              <lit-tag v="prn.pro.p3.mf.pl"/>
            </concat>
          </let>
        </when>
        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="whole"/>
            <concat>
              <lit v="lui"/>
              <lit-tag v="prn.pro.p3.mf.sg"/>
            </concat>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="direct_to_proclitic" npar="1">
      <choose>
        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="le"/>
          </let>
        </when>
        <when>
          <test> 
            <and>
              <equal>
                <clip pos="1" side="tl" part="pers"/>
                <lit-tag v="p3"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </and>
          </test> 
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="le"/>
          </let>
        </when>
      </choose>
    </def-macro>


    <def-macro n="comparatiu_nodet_adj1" npar="1"><!--per a afegir adverbi 'més' en adjs comparatius. -->
      <let>
        <var n="adjectiu1"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal>
              <var n="numero"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <var n="genero"/>
              <lit-tag v="mf"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="comp"/>
              </equal>
          </test>
          <append n="adjectiu1">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="sup"/>
              </equal>
          </test>
          <append n="adjectiu1">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <otherwise>
          <append n="adjectiu1">
            <lit v=""/>
          </append> 
        </otherwise>
      </choose>
    </def-macro>




    <def-macro n="comparatiu_adj1" npar="1"><!--per a afegir adverbi 'més' en adjs comparatius. -->
      <let>
        <var n="adjectiu1"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal>
              <var n="numero"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <var n="genero"/>
              <lit-tag v="mf"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="comp"/>
              </equal>
          </test>
          <append n="adjectiu1">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="sup"/>
              </equal>
          </test>
          <append n="adjectiu1">
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <var n="genero"/> 
            <var n="numero"/> 
            <lit v="$ ^"/>
          </append> 
          <append n="adjectiu1">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <otherwise>
          <append n="adjectiu1">
            <lit v=""/>
          </append> 
        </otherwise>
      </choose>
    </def-macro>



    <def-macro n="comparatiu_adj1-2" npar="1"><!--per a afegir adverbi 'més' en adjs comparatius. -->
      <let>
        <var n="adjectiu2"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal>
              <var n="numero"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <var n="genero"/>
              <lit-tag v="mf"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="comp"/>
              </equal>
          </test>
          <append n="adjectiu2">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <when>
          <test>
              <equal>
                <clip pos="1" side="sl" part="grau_adj"/>
                <lit-tag v="sup"/>
              </equal>
          </test>
          <append n="adjectiu2">
            <lit v="le"/>
            <lit-tag v="det.def"/>
            <var n="genero"/> 
            <var n="numero"/> 
            <lit v="$ ^"/>
          </append> 
          <append n="adjectiu2">
            <lit v="plus"/>
            <lit-tag v="preadv"/>
            <lit v="$ ^"/>
          </append>
        </when>
        <otherwise>
          <append n="adjectiu2">
            <lit v=""/>
          </append> 
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="envia_pas" npar="1">
      <choose>
        <when>
          <test>
            <equal caseless="yes">
              <clip pos="1" side="sl" part="lem"/>
              <lit v="no"/>
            </equal>
          </test>
          <out>
            <b/>
            <chunk name="pas">
              <tags>
                <tag>
                  <lit-tag v="adv"/>
                </tag>
              </tags>
              <lu>
                <lit v="pas"/>
                <lit-tag v="adv"/>
              </lu>
            </chunk>
          </out>
        </when>
      </choose>
    </def-macro>

    <def-macro n="def_det" npar="2">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="etiq_det"/>
            <lit-tag v="det.def.mf.pl"/>
          </let>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <var n="etiq_det"/>
                <lit-tag v="det.def.f.sg"/>
              </let>
            </when>
            <otherwise>
              <choose>
                <when>
                  <test>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="m"/>
                    </equal>
                  </test>
                  <let>
                    <var n="etiq_det"/>
                    <lit-tag v="det.def.m.sg"/>
                  </let>
                </when>
                <otherwise>
                  <choose>
                    <when>
                      <test>
                        <equal>
                          <clip pos="1" side="sl" part="gen"/>
                          <lit-tag v="f"/>
                        </equal>
                      </test>
                      <let>
                        <var n="etiq_det"/>
                        <lit-tag v="det.def.f.sg"/>
                      </let>
                    </when>
                    <otherwise>
                      <let>
                        <var n="etiq_det"/>
                        <lit-tag v="det.def.m.sg"/>
                      </let>
                    </otherwise>
                  </choose>
                </otherwise>
              </choose>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="pih_prh_past_cip" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="pih"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="temps"/>
            <lit-tag v="pii"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="prh"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="temps"/>
            <lit-tag v="pri"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="past"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="temps"/>
            <lit-tag v="ifi"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="cip"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="temps"/>
            <lit-tag v="cni"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="firstWord" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="a_np_acr"/>
              <lit v=""/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="EOS"/>
                  <lit v="true"/>
                </equal>
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="aa"/>
              </modify-case>
              <let>
                <var n="caseFirstWord"/>
                <lit v="Aa"/>
              </let>
            </when>
          </choose>
        </when>
        <otherwise>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
        </otherwise>
      </choose>
      <let>
        <var n="EOS"/>
        <lit v="false"/>
      </let>
    </def-macro>

    
 <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc cont?o no format. Cal posar aquesta funci?en les regles en qu?desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si cont?format cal conservar-la, si no en cont?cal eliminar-la perqu?no apareguin dos espais seguits. -->
      <choose>
	<when>
	  <test>
	    <not>
	      <equal>
		<b pos="1"/>
		<lit v=" "/>
	      </equal>
	    </not>
	  </test>
	  <out>
	    <b pos="1"/>
	  </out>
	</when>     	    
      </choose>
    </def-macro>
    
    <def-macro n="f_nploc" npar="1">
      <let>
        <var n="art_np"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="a_nom"/>
              <lit-tag v="np.top"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <in caseless="no">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="npf"/>
                </in>
              </test>
<!--
              <let>
                <var n="art_np"/>
                <concat>
                  <lit v="le"/>
                  <lit-tag v="det.def.f.sg"/>
                </concat>
              </let>
-->
	      <let>
	        <var n="genero"/> 
		<lit-tag v="f"/>
              </let>
	      <let>
	        <var n="numero"/> 
		<lit-tag v="sg"/>
              </let> 
              <let>
                <var n="lema_Prep"/>
                <lit v="en"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <in caseless="no">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="npm"/>
                </in>
              </test>
              <let>
                <var n="art_np"/>
                <concat>
                  <lit v="le"/>
                  <lit-tag v="det.def.m.sg"/>
                </concat>
              </let>
	      <let>
	        <var n="genero"/> 
		<lit-tag v="m"/>
              </let>
	      <let>
	        <var n="numero"/> 
		<lit-tag v="sg"/>
              </let> 
              <let>
                <var n="lema_Prep"/>
                <lit v="à"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <in caseless="no">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="nppl"/>
                </in>
              </test>
              <let>
                <var n="art_np"/>
                <concat>
                  <lit v="le"/>
                  <lit-tag v="det.def.mf.pl"/>
                </concat>
              </let>
	      <let>
	        <var n="genero"/> 
		<lit-tag v="mf"/>
              </let>
	      <let>
	        <var n="numero"/> 
		<lit-tag v="pl"/>
              </let> 
              <let>
                <var n="lema_Prep"/>
                <lit v="à"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <or>
                  <in caseless="no">
                    <clip pos="1" side="sl" part="lem"/>
                    <list n="menezioù"/>
                  </in>
                  <in caseless="yes">
                    <clip pos="1" side="sl" part="lem"/>
                    <list n="broioùbreizh"/>
                  </in>
                </or>
              </test>
              <let>
                <var n="lema_Prep"/>
                <lit v="dans"/>
              </let>
             </when>
          </choose>
        </when>
      </choose>
    </def-macro>

    <def-macro n="genderise_participle1" npar="1">
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="a_pp"/>
                    <lit-tag v="vbser.pp"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="vbser.pp.GD.ND"/>
                </let>
              </when>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="a_pp"/>
                    <lit-tag v="vblex.pp"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="vblex.pp.GD.ND"/>
                </let>
              </when>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="a_pp"/>
                    <lit-tag v="vbmod.pp"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="vbmod.pp.GD.ND"/>
                </let>
              </when>
            </choose>
     </def-macro>

     <def-macro n="f_concord1" npar="1">
       <call-macro n="genderise_participle1">
         <with-param pos="1"/>
       </call-macro>

      <choose>
<!--To determine value of variables of gender and
                 number and propagate to other rules.  Variables are
                 not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>      
	<when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mf"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="mf"/>
          </let>
        </when>
      </choose>
    
    
    
    
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
	<when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sp"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sp"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- If word has GD or ND, we try to assign the
              gender or number of the previous rule. If there is no
              value for the gender or number variable from previous
              rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>
    
    
    
    
    <def-macro n="f_concord2" npar="2">

       <call-macro n="genderise_participle1">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="2"/>
       </call-macro>

      <choose>
        <when>
          <test>
<!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
<!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
<!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
<!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <or>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </and>
            </or>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
<!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
<!--       <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>-->
      </choose>
<!-- Determine gender and number value if they are undetermined -->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord3" npar="3">
       <call-macro n="genderise_participle1">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="3"/>
       </call-macro>



      <choose>
<!-- Look whether in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Look whether in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
<!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
<!--			<when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
             <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </when>-->
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </otherwise>
      </choose>
      <choose>
<!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
      </choose>
      <choose>
<!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="f_concord4" npar="4">
       <call-macro n="genderise_participle1">
         <with-param pos="1"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="2"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="3"/>
       </call-macro>
       <call-macro n="genderise_participle1">
         <with-param pos="4"/>
       </call-macro>


      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
<!--		<when>
          <test>
						<and>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
           <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
           <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
           <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
						</and>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </when>-->
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="4" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="vauxiliar" npar="2">
      <choose>
        <when>
          <test>
          <or>
            <in caseless="yes">
              <clip pos="2" side="tl" part="lem"/>
              <list n="vbambser"/>
            </in>
            <equal>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="fti"/>
            </equal> 
          </or>
          </test>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="être"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="a_verb"/>
            <lit-tag v="vbser"/>
          </let> 
	  <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
	<otherwise>
	 <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="avoir"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="a_verb"/>
            <lit-tag v="vbhaver"/>
          </let> 
	
	</otherwise>
      </choose>
    </def-macro>
    <def-macro n="vauxiliar_pro" npar="3">
      <choose>
        <when>
          <test>
            <or>
              <in caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <list n="vbambser"/>
              </in>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="tipoenc_pro"/>
                  <lit-tag v="ref.p3.mf.sp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="pers"/>
                  <lit-tag v="p2"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="pers"/>
                  <lit-tag v="p2"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <clip pos="2" side="sl" part="nbr"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="1" side="sl" part="pers"/>
                  <lit-tag v="p1"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="pers"/>
                  <lit-tag v="p1"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <clip pos="2" side="sl" part="nbr"/>
                </equal>
              </and>
            </or>
          </test>
          <let>
            <clip pos="2" side="tl" part="lem"/>
            <lit v="être"/>
          </let>
          <let>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="vbser"/>
          </let>
        </when>
      </choose>
    </def-macro>
    <def-macro n="aux_ifi" npar="1">
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="haber"/>
              </equal>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="a_verb"/>
                <lit v="vbhaver"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="auxiliar"/>
            <lit v="y avoir"/>
          </let>
          <let>
            <clip pos="1" side="tl" part="lem"/>
            <lit v="avoir"/>
          </let>
          <let>
            <var n="etiq_aux"/>
            <lit-tag v="vblex"/>
          </let>
        </when>
        <otherwise>
          <choose>
            <when>
              <test>
                <in caseless="yes">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="vbambser"/>
                </in>
              </test>
              <let>
                <var n="auxiliar"/>
                <lit v="être"/>
              </let>
              <let>
                <var n="etiq_aux"/>
                <lit-tag v="vbser"/>
              </let>
            </when>
            <otherwise>
              <let>
                <var n="auxiliar"/>
                <lit v="avoir"/>
              </let>
              <let>
                <var n="etiq_aux"/>
                <lit-tag v="vbhaver"/>
              </let>
            </otherwise>
          </choose>
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_concord_prn_pp" npar="2">
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="sl" part="a_pp"/>
                    <lit-tag v="vblex.pp"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="vblex.pp.GD.ND"/>
                </let>
              </when>
            </choose>

      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="nt"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <clip pos="1" side="tl" part="gen"/>
          </let> 
	 <let>
            <var n="genero"/>
            <clip pos="1" side="tl" part="gen"/>
          </let> 
        </when>
        <otherwise>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="m"/>
          </let>  
	 <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let> 
        </otherwise>
      </choose>

      <choose>
        <when>
          <test>
<!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="nt"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>          
	 <let>
            <var n="numero"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let> 
	</when>
        <otherwise>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <lit-tag v="sg"/>
          </let>          
	 <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let> 
        </otherwise>
      </choose>
    </def-macro>
  </section-def-macros>

  <section-rules>

<!--*************************************** REGLES DE SN ******************************************** -->

    <rule comment="REGLA: NOM (per a collocar la cua en les multiparaules amb g">
		<pattern>
			<pattern-item n="nom"/>
		</pattern>
		<action>
			<call-macro n="f_concord1">
				<with-param pos="1"/>
			</call-macro>
			<call-macro n="firstWord">
				<with-param pos="1"/>
			</call-macro>
			<choose>
				<when>
					<test>
                                            <or>
                                                <equal>
                                                  <clip pos="1" side="tl" part="nbr"/> 
                                                  <lit-tag v="pl"/>
                                                </equal>
						<in caseless="yes">
							<clip pos="1" side="tl" part="lem"/>
							<list n="part_sing"/>
						</in>
                                          </or>
					</test>
					<out>
						<chunk name="part" case="caseFirstWord">
							<tags>
								<tag><lit-tag v="SN"/></tag>
								<tag><clip pos="1" side="tl" part="gen"/></tag>
								<tag><clip pos="1" side="tl" part="nbr"/></tag>
							</tags>
							<lu>
								<clip pos="1" side="tl" part="lemh"/> 
								<clip pos="1" side="tl" part="a_nom"/>
								<clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
								<clip pos="1" side="tl" part="gen_mf"/>	 
								<clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
								<clip pos="1" side="tl" part="nbr_sp"/>	 
								<clip pos="1" side="tl" part="lemq"/>
							</lu>
						</chunk>
					</out>
				</when>
				<otherwise>
					<out>
						<chunk name="nom" case="caseFirstWord">
							<tags>
								<tag><lit-tag v="SN"/></tag>
								<tag><clip pos="1" side="tl" part="gen"/></tag>
								<tag><clip pos="1" side="tl" part="nbr"/></tag>
							</tags>
							<lu>
								<clip pos="1" side="tl" part="lemh"/> 
								<clip pos="1" side="tl" part="a_nom"/>
								<clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
								<clip pos="1" side="tl" part="gen_mf"/>	 
								<clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
								<clip pos="1" side="tl" part="nbr_sp"/>	 
								<clip pos="1" side="tl" part="lemq"/>
							</lu>
						</chunk>
					</out>
				</otherwise>
			</choose>
			<let>
				<var n="caseFirstWord"/>
				<lit v="aa"/>
			</let>
		</action>
	</rule>
     
    <rule comment="REGLA: PREP DET LOCATIU">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="det"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <let>
          <var n="lema_Prep"/>
          <lit v="à"/>
        </let>
        <call-macro n="firstWord">
          <with-param pos="3"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="3"/>
        </call-macro>
        <out>
              <chunk name="nploc" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag>
                    <var n="genero"/></tag>
                  <tag>
                    <var n="numero"/></tag>
                </tags>
		<lu>
                  <var n="lema_Prep"/>
                  <lit-tag v="pr"/>
		</lu>
		<b pos="1"/>
		<lu>
		  <var n="art_np"/>
		</lu>
		<b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
              </chunk>
       </out>

            <let>
              <var n="caseFirstWord"/>
              <lit v="aa"/>
            </let>
      </action>
    </rule>
 
     
    <rule comment="REGLA: PREP LOCATIU">
      <pattern>
        <pattern-item n="prep"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <let>
          <var n="lema_Prep"/>
          <lit v="à"/> 
        </let>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <not>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="e"/>
                </equal>
              </not>
            </test>
            <let> 
              <var n="lema_Prep"/>
              <clip pos="1" side="tl" part="lem"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let> 
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <var n="art_np"/>
                <lit v=""/> 
              </equal>
            </test>
            <out>
              <chunk name="pr_nploc" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <var n="lema_Prep"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
              </chunk>
           </out>
          </when>
          <otherwise>
            <out>
              <chunk name="pr_nploc" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
    	    <lu>
                  <var n="lema_Prep"/>
                  <lit-tag v="pr"/>
    	    </lu>
    	    <b pos="1"/>
    	    <lu>
    	      <var n="art_np"/>
    	    </lu>
                <b/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
              </chunk>
           </out>
         </otherwise>
       </choose>
            <let>
              <var n="caseFirstWord"/>
              <lit v="aa"/>
            </let>
      </action>
    </rule>
    
  
    <rule comment="REGLA: LOCATIUS">
      <pattern>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let> 
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
                <in caseless="no">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="npf"/>
                </in>
            </test>
            <let>
              <var n="art_np"/>
              <concat>
                <lit v="le"/>
                <lit-tag v="det.def.f.sg"/>
              </concat>
            </let>
          </when>
        </choose>
            <out>
              <chunk name="nploc" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <var n="art_np"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
            <let>
              <var n="caseFirstWord"/>
              <lit v="aa"/>
            </let>
      </action>
    </rule>  
    
   
    
    <rule comment="REGLA: DET LOCATIU">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	   <out>
              <chunk name="det_nploc" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><lit-tag v="sg"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
      </action>
    </rule>  
    
  
    <rule comment="REGLA: ANTROPÒNIM">
      <pattern>
        <pattern-item n="ant"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="ant" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <lit-tag v="sg"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: 2 ANTROPÒNIMS (px. maria lópez)">
      <pattern>
        <pattern-item n="ant"/>
        <pattern-item n="ant"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="ant" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <lit-tag v="sg"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: 3 ANTROPÒNIMS (px. maria lópez váquez)">
      <pattern>
        <pattern-item n="ant"/>
        <pattern-item n="ant"/>
        <pattern-item n="ant"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="ant" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <lit-tag v="sg"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
    <rule comment="REGLA: det_indef nom → det (paire de)? nom">
      <pattern>
        <pattern-item n="det_indef"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

      <choose>
        <when>
          <test>
            <and>
                <in caseless="yes">
                  <clip pos="2" side="sl" part="lem"/>
                  <list n="nom_indef_paire"/>
                </in>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="pl"/>
                </equal>
            </and>
          </test>
          <out>
           <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><lit-tag v="f.sg"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <lit-tag v="f.sg"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="paire"/>
              <lit-tag v="n.f.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>

          </out>
        </when>
        <otherwise>

      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
       </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    
    <rule comment="REGLA: DET memes NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="memes"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="meur a"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="bep"/>
                </equal>
              </or>
              <not>
                <equal>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
      
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <lit-tag v="adj.ind.mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    


          
    <rule comment="REGLA: DET NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="meur a"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="bep"/>
                </equal>
              </or>
              <not>
                <equal>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
      
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="3"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="4"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: DET NOM nemet indirect">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nemet"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="meur a"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="bep"/>
                </equal>
              </or>
              <not>
                <equal>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
      
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="seul"/>
              <lit-tag v="adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

    
    <rule comment="REGLA: DET NOM ADJ nemet indirect">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="nemet"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="meur a"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="bep"/>
                </equal>
              </or>
              <not>
                <equal>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
      
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_adj_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="seul"/>
              <lit-tag v="adj.2.3"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    
    <rule comment="REGLA: DET NOM A NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
      <choose>
        <when>
          <test>
            <and>
              <equal caseless="yes">
                <clip pos="1" side="sl" part="lem"/>
                <lit v="meur a"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <clip pos="1" side="tl" part="nbr"/>
          </let>
        </when>
      </choose>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
      <choose>
        <when>
          <test>
              <equal>
                <clip pos="2" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
          </test>
          <let> <!-- ugh :( -->
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="m.sg"/>
          </let>
        </when>
      </choose>
            <let>
              <var n="lu_Prep"/>
              <concat>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </concat>
            </let>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom_pr_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
  <!--            <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/> -->
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="lu_Prep"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf" />
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
   
<!-- No pot passar mai

    <rule comment="REGLA: NOM DEM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
-->
 
    
    <rule comment="REGLA: DET NOM DEM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    

    <rule comment="REGLA: RE LOCATIU">
      <pattern>
        <pattern-item n="re"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="no">
                  <clip pos="2" side="tl" part="lem"/>
                  <list n="npf"/>
                </in>
            </test>
            <let>
              <var n="art_np"/>
              <concat>
                <lit v="le"/>
                <lit-tag v="det.def.f.sg"/>
              </concat>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="celui_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <var n="art_np"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 


  
    <rule comment="REGLA: NOM LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="no">
                  <clip pos="2" side="tl" part="lem"/>
                  <list n="npf"/>
                </in>
            </test>
            <let>
              <var n="art_np"/>
              <concat>
                <lit v="le"/>
                <lit-tag v="det.def.f.sg"/>
              </concat>
            </let>
          </when>
        </choose>

        <choose> <!-- UGLY HACK IS UGLY :( -->
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="pl"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sg"/>
                </equal>
              </and>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="det_nom_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <var n="art_np"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: NOM ANT">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="ant"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_ant" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: DET NOM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <clip pos="2" side="sl" part="gen"/>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <list n="substances"/>
              </in>
            </test>
            <let>
              <var n="lema_Prep"/>
              <concat>
                <lit v="^en"/>
                <lit-tag v="pr"/>
                <lit v="$ "/>
              </concat>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
            </test>
            <let>
              <var n="lema_Prep"/>
              <lit v=""/>
            </let>
          </when>
          <otherwise>
            <let>
              <var n="lema_Prep"/>
              <concat>
                <lit v="^de"/>
                <lit-tag v="pr"/>
                <lit v="$ "/>
              </concat>
            </let>
          </otherwise>
        </choose>

        <out>
          <chunk name="det_nom_pr_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <var n="lema_Prep"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  

 
    <rule comment="REGLA: DET NOM NOM DEM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <clip pos="2" side="sl" part="gen"/>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <list n="substances"/>
              </in>
            </test>
            <let>
              <var n="lema_Prep"/>
              <concat>
                <lit v="^en"/>
                <lit-tag v="pr"/>
                <lit v="$ "/>
              </concat>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <clip pos="3" side="tl" part="a_nom"/>
                <lit-tag v="np.al"/>
              </equal>
            </test>
            <let>
              <var n="lema_Prep"/>
              <lit v=""/>
            </let>
          </when>
          <otherwise>
            <let>
              <var n="lema_Prep"/>
              <concat>
                <lit v="^de"/>
                <lit-tag v="pr"/>
                <lit v="$ "/>
              </concat>
            </let>
          </otherwise>
        </choose>

        <out>
          <chunk name="det_nom_pr_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <var n="lema_Prep"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  

 
    <rule comment="REGLA: NOM NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <let>
          <var n="art1"/>
          <lit v=""/>
        </let>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <clip pos="1" side="sl" part="gen"/>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="substances"/>
              </in>
            </test>
            <let>
              <var n="lema_Prep"/>
              <lit v="en"/>
            </let>
          </when>
          <otherwise>
            <let>
              <var n="lema_Prep"/>
              <lit v="de"/>
            </let>
            <let>
              <var n="art1"/>
              <concat>
                <lit v="^le"/>
                <lit-tag v="det.def"/>
<!--
                <clip pos="1" side="tl" part="gen_sense_mf"/>
                <clip pos="1" side="tl" part="gen_mf"/>
-->
                <var n="genero"/>
                <var n="numero"/>
                <lit v="$ "/>
              </concat>
            </let>
          </otherwise>
        </choose>

        <out>
          <chunk name="det_nom_pr_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <var n="art1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <var n="lema_Prep"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  
    <rule comment="REGLA: NOM NOM ANT">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="ant"/>
      </pattern>
      <action>
        <let>
          <var n="art1"/>
          <lit v=""/>
        </let>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="substances"/>
              </in>
            </test>
            <let>
              <var n="lema_Prep"/>
              <lit v="en"/>
            </let>
          </when>
          <otherwise>
            <let>
              <var n="lema_Prep"/>
              <lit v="de"/>
            </let>
            <let>
              <var n="art1"/>
              <concat>
                <lit v="^le"/>
                <lit-tag v="det.def"/>
                <clip pos="2" side="tl" part="gen_sense_mf"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <var n="numero"/>
                <lit v="$ "/>
              </concat>
            </let>
          </otherwise>
        </choose>
        <out>
          <chunk name="det_nom_prep_det_nom_de_ant" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <var n="lema_Prep"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <var n="art1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="REGLA: NOM NOM LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="3"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  
 
    <rule comment="REGLA: NOM NOM NOM LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="4"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom_de_nom_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
<!--
              <var n="numero"/>
-->
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b/>            
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  

 
    <rule comment="REGLA: NOM NOM NOM NOM LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="5"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom_de_det_nom_de_nom_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>            
<!--
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
-->
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b/>            
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen_sense_mf"/>
              <clip pos="5" side="tl" part="gen_mf"/>
              <clip pos="5" side="tl" part="nbr_sense_sp"/>
              <clip pos="5" side="tl" part="nbr_sp"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  

 

 
    <rule comment="REGLA: NOM DET LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
	<call-macro n="f_nploc">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="det_nom_de_loc" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <var n="art_np"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: RE DET NOM">
      <pattern>
        <pattern-item n="re"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="celui_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: RE NOM DET NOM">
      <pattern>
        <pattern-item n="re"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="celui_de_det_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_det"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 

 
    <rule comment="REGLA: NOM DET NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="REGLA: ORDINAL NOM DET NOM">
      <pattern>
        <pattern-item n="ord"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>

        </choose>

        <out>
          <chunk name="det_ord_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def.2.3"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_det"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  
    <rule comment="REGLA: NUM gwezh DET temp_nom">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="gwezh"/>
        <pattern-item n="det"/>
        <pattern-item n="temp_nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="num_fois_par_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="par"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


 
    <rule comment="REGLA: NUM NOM DET NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>

        </choose>

        <out>
          <chunk name="num_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_det"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="REGLA: NUM NOM DET NOM DEM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>

        </choose>

        <out>
          <chunk name="num_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
<!--
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_det"/>
-->
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  
    <rule comment="REGLA: NOM DET NOM DEM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
<!--
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
-->
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="REGLA: NOM DET NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>

        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>
            <call-macro n="comparatiu_nodet_adj1">
              <with-param pos="4"/>
            </call-macro>
           <out>
             <chunk name="det_nom_de_det_adj_nom" case="caseFirstWord">
               <tags>
                 <tag><lit-tag v="SN"/></tag>
                 <tag><var n="genero"/></tag>
                 <tag><var n="numero"/></tag>
               </tags>
               <lu>
                 <lit v="le"/>
                 <lit-tag v="det.def"/>
                 <clip pos="1" side="tl" part="gen_sense_mf"/>
                 <clip pos="1" side="tl" part="gen_mf"/>
                 <var n="numero"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_nom"/>
                 <clip pos="1" side="tl" part="gen_sense_mf"/>
                 <clip pos="1" side="tl" part="gen_mf"/>
                 <clip pos="1" side="tl" part="nbr_sense_sp"/>
                 <clip pos="1" side="tl" part="nbr_sp"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="de"/>
                 <lit-tag v="pr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_det"/>
                 <clip pos="2" side="tl" part="gen_sense_mf"/>
                 <clip pos="2" side="tl" part="gen_mf"/>
                 <clip pos="2" side="tl" part="nbr_sense_sp"/>
                 <clip pos="2" side="tl" part="nbr_sp"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <var n="adjectiu1"/>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_adj"/>
                 <clip pos="4" side="tl" part="gen_sense_mf"/>
                 <clip pos="4" side="tl" part="gen_mf"/>
                 <clip pos="4" side="tl" part="nbr_sense_sp"/>
                 <clip pos="4" side="tl" part="nbr_sp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
               <b pos="3"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_nom"/>
                 <clip pos="3" side="tl" part="gen_sense_mf"/>
                 <clip pos="3" side="tl" part="gen_mf"/>
                 <clip pos="3" side="tl" part="nbr_sense_sp"/>
                 <clip pos="3" side="tl" part="nbr_sp"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
   
             </chunk>
           </out>
         </when> 
         <otherwise>
           <call-macro n="comparatiu_adj1">
             <with-param pos="4"/>
           </call-macro>
           <out>
             <chunk name="det_nom_de_det_nom_adj" case="caseFirstWord">
               <tags>
                 <tag><lit-tag v="SN"/></tag>
                 <tag><var n="genero"/></tag>
                 <tag><var n="numero"/></tag>
               </tags>
               <lu>
                 <lit v="le"/>
                 <lit-tag v="det.def"/>
                 <clip pos="1" side="tl" part="gen_sense_mf"/>
                 <clip pos="1" side="tl" part="gen_mf"/>
                 <var n="numero"/>
               </lu>
               <b pos="1"/>
               <lu>
                 <clip pos="1" side="tl" part="lemh"/>
                 <clip pos="1" side="tl" part="a_nom"/>
                 <clip pos="1" side="tl" part="gen_sense_mf"/>
                 <clip pos="1" side="tl" part="gen_mf"/>
                 <clip pos="1" side="tl" part="nbr_sense_sp"/>
                 <clip pos="1" side="tl" part="nbr_sp"/>
                 <clip pos="1" side="tl" part="lemq"/>
               </lu>
               <b/>
               <lu>
                 <lit v="de"/>
                 <lit-tag v="pr"/>
               </lu>
               <b/>
               <lu>
                 <clip pos="2" side="tl" part="lemh"/>
                 <clip pos="2" side="tl" part="a_det"/>
                 <clip pos="2" side="tl" part="gen_sense_mf"/>
                 <clip pos="2" side="tl" part="gen_mf"/>
                 <clip pos="2" side="tl" part="nbr_sense_sp"/>
                 <clip pos="2" side="tl" part="nbr_sp"/>
                 <clip pos="2" side="tl" part="lemq"/>
               </lu>
               <b pos="2"/>
               <lu>
                 <clip pos="3" side="tl" part="lemh"/>
                 <clip pos="3" side="tl" part="a_nom"/>
                 <clip pos="3" side="tl" part="gen_sense_mf"/>
                 <clip pos="3" side="tl" part="gen_mf"/>
                 <clip pos="3" side="tl" part="nbr_sense_sp"/>
                 <clip pos="3" side="tl" part="nbr_sp"/>
                 <clip pos="3" side="tl" part="lemq"/>
               </lu>
               <b pos="3"/>
               <lu>
                 <var n="adjectiu1"/>
                 <clip pos="4" side="tl" part="lemh"/>
                 <clip pos="4" side="tl" part="a_adj"/>
                 <clip pos="4" side="tl" part="gen_sense_mf"/>
                 <clip pos="4" side="tl" part="gen_mf"/>
                 <clip pos="4" side="tl" part="nbr_sense_sp"/>
                 <clip pos="4" side="tl" part="nbr_sp"/>
                 <clip pos="4" side="tl" part="lemq"/>
               </lu>
   
             </chunk>
           </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: NOM ADJ DET NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>
            <call-macro n="comparatiu_nodet_adj1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="det_adj_nom_de_det_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <var n="numero"/>
                </lu>
                <b/>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_det"/>
                  <clip pos="3" side="tl" part="gen_sense_mf"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_nom"/>
                  <clip pos="4" side="tl" part="gen_sense_mf"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <call-macro n="comparatiu_adj1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="det_nom_adj_de_det_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <var n="numero"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_det"/>
                  <clip pos="3" side="tl" part="gen_sense_mf"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_nom"/>
                  <clip pos="4" side="tl" part="gen_sense_mf"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
  
    <rule comment="REGLA: NOM ADJ LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_nploc">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>
            <call-macro n="comparatiu_nodet_adj1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="det_adj_nom_de_top" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <var n="numero"/>
                </lu>
                <b/>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <var n="art_np"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <call-macro n="comparatiu_adj1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="det_nom_adj_de_top" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <var n="numero"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <var n="art_np"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
    <rule comment="REGLA: ADJ NOM LOCATIU">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="adj_nom_de_top" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_adj"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

 
    <rule comment="REGLA: NOM ADJ NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="det_nom_adj_de_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 

  
    <rule comment="REGLA: NOM ADJ NOM LOCATIU">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="loc"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="det_nom_adj_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 

 
    <rule comment="REGLA: NOM NOM ADJ DET NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="5"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="det_nom_de_det_nom_adj_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <lit-tag v="3"/>
<!--
              <clip pos="1" side="tl" part="nbr_sense_mf" link-to="3"/>
              <var n="numero"/>
-->
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_det"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen_sense_mf"/>
              <clip pos="5" side="tl" part="gen_mf"/>
              <clip pos="5" side="tl" part="nbr_sense_sp"/>
              <clip pos="5" side="tl" part="nbr_sp"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="REGLA: NOM NOM DET NOM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1"> <!-- @@ -->
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_nom_de_det_nom_de_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <var n="numero"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="le"/>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_det"/>
              <clip pos="3" side="tl" part="gen_sense_mf"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
    <rule comment="REGLA: PREDET DET NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="predet_det_nom" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
    <rule comment="REGLA: PREDET DET NOM DEM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="predet_det_nom" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

     
    <rule comment="REGLA: PREDET DET NOM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="predet_det_nom_de_nom" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
 
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
      
    <rule comment="REGLA: POS-NUM">
      <pattern>
        <pattern-item n="hon_hor_ho_o"/>
        <pattern-item n="guio"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
            <out>
              <chunk name="det_num" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <get-case-from pos="1">
                    <lit v="tout"/>
                  </get-case-from>
                  <lit-tag v="predet"/>
                  <clip pos="1" side="tl" part="gen" link-to="2"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                </lu>
                <b/>
                <lu>
                  <get-case-from pos="2">
                    <lit v="le"/>
                  </get-case-from>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_num"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>




     
    <rule comment="REGLA: DET NUM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal caseless="yes">
                <clip pos="2" side="tl" part="a_num"/>
                <lit-tag v="num.percent"/>
              </equal>
            </test>
            <out>
              <chunk name="nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <lit-tag v="m.sg"/>
                  </tag>
                </tags>
                <lu>
                  <get-case-from pos="1">
                    <clip pos="2" side="tl" part="lem"/>
                  </get-case-from>
                  <lit-tag v="num.percent"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
	      <with-param pos="2"/>
	    </call-macro>
          </when>
          <otherwise>
            <out>
              <chunk name="det_num" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_num"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: PRNPOS NOM">
      <pattern>
        <pattern-item n="prnpos"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="prn_pos_to_det_pos">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
          <out>
            <chunk name="det_paire_de_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <lit-tag v="det.pos"/>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="sg"/>
              </lu> 
              <b/>
              <lu>
                <lit v="paire"/> 
                <lit-tag v="n.f.sg"/> 
              </lu>
              <b/>
              <lu>
                <lit v="de"/> 
                <lit-tag v="pr"/> 
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
      </action>
    </rule>
 
    
    <rule comment="REGLA: NUM NOM bennak">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="bennak"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
          <out>
            <chunk name="environ_num_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <lit v="environ"/> 
                <lit-tag v="adv"/> 
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
      </action>
    </rule>
 
    
    <rule comment="REGLA: NUM NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="meses"/>
              </in>
            </test>
            <out>
              <chunk name="num_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="1"/>
	      <with-param pos="2"/>
            </call-macro>
          </when>
          <otherwise>
          <call-macro n="f_concord2">
            <with-param pos="1"/>
            <with-param pos="2"/>
          </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
          <out>
            <chunk name="num_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
          </otherwise>
        </choose>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NUM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="sl" part="lem"/>
                <list n="meses"/>
              </in>
            </test>
            <call-macro n="f_concord1">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="f_concord1">
              <with-param pos="1"/>
            </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->

            <out>
              <chunk name="det_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="2"/>
	      <with-param pos="3"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord3">
              <with-param pos="2"/> 
              <with-param pos="3"/>
              <with-param pos="1"/>
            </call-macro>
            <choose>
              <when> 
                <test>
                  <equal>
                    <clip pos="2" side="tl" part="nbr"/>
                    <lit-tag v="sp"/>
                  </equal>
                </test>
                <let>
                   <var n="numero"/>
                   <lit-tag v="pl"/> <!--  Ar c’hwec’h den -->
                </let>
              </when>
<!-- Ezhomm zo da ziorren an eil derez 
              <otherwise>
                <let>
                  <var n="numero"/>
                  <clip pos="2" side="sl" part="nbr"/>
                </let>
              </otherwise>
-->
            </choose>
            <out>
              <chunk name="det_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>
 
    <rule comment="REGLA: DET NUM NOM DEM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/> 
          <with-param pos="3"/> 
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="2" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="det_num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <lit v="ce"/>
              <lit-tag v="det.dem"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    
    <rule comment="REGLA: DET NUM DE NOM DE NUM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="de"/>
        <pattern-item n="nom"/>
        <pattern-item n="de"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="sl" part="lem"/>
                <list n="meses"/>
              </in>
            </test>
            <out>
              <chunk name="det_num_nom_num" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
            <call-macro n="f_bcond">
              <with-param pos="5"/>
              <with-param pos="6"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <chunk name="det_num_prep_nom_prep_num" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_nom"/>
                  <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="6" side="tl" part="lemh"/>
                  <clip pos="6" side="tl" part="a_nom"/>
                  <clip pos="6" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="6" side="tl" part="gen_mf"/>
                  <clip pos="6" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="6" side="tl" part="nbr_sp"/>
                  <clip pos="6" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

    
    <rule comment="REGLA: DA DET NUM NOM">
      <pattern>
        <pattern-item n="da"/>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="yes">
                  <clip pos="4" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
            </test>
            <out>
              <chunk name="det_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord3">
              <with-param pos="2"/>
              <with-param pos="3"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <chunk name="prep_det_num_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_nom"/>
                  <clip pos="4" side="tl" part="gen_sense_mf"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
      
    <rule comment="REGLA: NUM A NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
            </test>
            <out>
              <chunk name="num_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_num"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>

                </lu>
                <b pos="1"/>
                <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>

                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="2"/>
	      <with-param pos="3"/>
            </call-macro>
          </when>
          <otherwise>
            <out>
              <chunk name="num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
       
    <rule comment="REGLA: DA DET NUM A NOM">
      <pattern>
        <pattern-item n="da"/>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="yes">
                  <clip pos="5" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
            </test>
            <let>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
            <out>
              <chunk name="det_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="prep_det_num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="5" side="tl" part="lemh"/>
                  <clip pos="5" side="tl" part="a_nom"/>
                  <clip pos="5" side="tl" part="gen_sense_mf"/>
                  <clip pos="5" side="tl" part="gen_mf"/>
                  <clip pos="5" side="tl" part="nbr_sense_sp"/>
                  <clip pos="5" side="tl" part="nbr_sp"/>
                  <clip pos="5" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
       
    <rule comment="REGLA: DA DET NUM CC NUM A NOM">
      <pattern>
        <pattern-item n="da"/>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="num"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->
        <call-macro n="f_concord1">
          <with-param pos="7"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
                <in caseless="yes">
                  <clip pos="7" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
            </test>
            <out>
              <chunk name="det_num_cnjcoo_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="prep_det_num_cnjcoo_num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="6"/>
                <lu>
                  <clip pos="7" side="tl" part="lemh"/>
                  <clip pos="7" side="tl" part="a_nom"/>
                  <clip pos="7" side="tl" part="gen_sense_mf"/>
                  <clip pos="7" side="tl" part="gen_mf"/>
                  <clip pos="7" side="tl" part="nbr_sense_sp"/>
                  <clip pos="7" side="tl" part="nbr_sp"/>
                  <clip pos="7" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
      
    <rule comment="REGLA: DA DET NOM NUM NOM">
      <pattern>
        <pattern-item n="da"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->
        <call-macro n="f_concord1">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <list n="dias"/>
                </in>
                <in caseless="yes">
                  <clip pos="5" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
              </and>
            </test>
            <out>
              <chunk name="det_nom_num_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="prep_det_nom_num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="5" side="tl" part="lemh"/>
                  <clip pos="5" side="tl" part="a_nom"/>
                  <clip pos="5" side="tl" part="gen_sense_mf"/>
                  <clip pos="5" side="tl" part="gen_mf"/>
                  <clip pos="5" side="tl" part="nbr_sense_sp"/>
                  <clip pos="5" side="tl" part="nbr_sp"/>
                  <clip pos="5" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
      
    <rule comment="REGLA: DA DET NOM NUM A NOM">
      <pattern>
        <pattern-item n="da"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="num"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="2"/>
        </call-macro>
<!--
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
-->
        <call-macro n="f_concord1">
          <with-param pos="6"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <list n="dias"/>
                </in>
                <in caseless="yes">
                  <clip pos="6" side="sl" part="lem"/>
                  <list n="meses"/>
                </in>
              </and>
            </test>
            <out>
              <chunk name="det_nom_num_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="3"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="prep_det_nom_num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="6" side="tl" part="lemh"/>
                  <clip pos="6" side="tl" part="a_nom"/>
                  <clip pos="6" side="tl" part="gen_sense_mf"/>
                  <clip pos="6" side="tl" part="gen_mf"/>
                  <clip pos="6" side="tl" part="nbr_sense_sp"/>
                  <clip pos="6" side="tl" part="nbr_sp"/>
                  <clip pos="6" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
   <rule comment="REGLA: DET NUM A NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="a"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
<!--
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
-->
        <call-macro n="f_concord1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="sl" part="lem"/>
                <list n="meses"/>
              </in>
            </test>
            <out>
              <chunk name="det_num_nom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
            <call-macro n="f_bcond">
              <with-param pos="3"/>
	      <with-param pos="4"/>
            </call-macro>
          </when>
          <otherwise>
            <call-macro n="f_concord2">
              <with-param pos="2"/>
              <with-param pos="1"/>
            </call-macro>
            <out>
              <chunk name="det_num_prep_nom" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_nom"/>
                  <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
   <rule comment="REGLA: NOM ADJ ADV">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adv"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <list n="part_sing"/>
              </in>
            </test>
            <out>
              <chunk name="partnom_adv_adj" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="nom_adv_adj" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SN"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
   <rule comment="REGLA: NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>
            <call-macro n="comparatiu_nodet_adj1">
              <with-param pos="2"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="part_sing"/>
                  </in>
                </test>
                <out>
                  <chunk name="partadj_nom" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_adj"/>
                      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>                      
                <out>
                  <chunk name="adj_nom" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_adj"/>
                      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </otherwise>
            </choose>
           </when>
           <otherwise>
           <call-macro n="comparatiu_adj1">
              <with-param pos="2"/>
           </call-macro>
           <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="part_sing"/>
                  </in>
                </test>
                <out>
                  <chunk name="partnom_adj" case="caseFirstWord">
                    <tags>
                      <tag>
                        <lit-tag v="SN"/>
                      </tag>
                      <tag>
                        <var n="genero"/>
                      </tag>
                      <tag>
                        <var n="numero"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_adj"/>
                      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>
                <out>
                  <chunk name="nom_adj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_adj"/>
                      <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </otherwise>
            </choose>

           </otherwise>
         </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
   
   <rule comment="REGLA: NOM NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>
            <call-macro n="comparatiu_nodet_adj1">
              <with-param pos="3"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="part_sing"/>
                  </in>
                </test>
                <out>
                  <chunk name="partnom_de_adj_nom" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <lit v="de"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_adj"/>
                      <clip pos="3" side="tl" part="gen_sense_mf"/>
                      <clip pos="3" side="tl" part="gen_mf"/>
                      <clip pos="3" side="tl" part="nbr_sense_sp"/>
                      <clip pos="3" side="tl" part="nbr_sp"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                    <b pos="2"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_nom"/>
                      <clip pos="2" side="tl" part="gen_sense_mf"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>                      
                <out>
                  <chunk name="nom_de_adj_nom" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <lit v="de"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_adj"/>
                      <clip pos="3" side="tl" part="gen_sense_mf"/>
                      <clip pos="3" side="tl" part="gen_mf"/>
                      <clip pos="3" side="tl" part="nbr_sense_sp"/>
                      <clip pos="3" side="tl" part="nbr_sp"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                    <b pos="2"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_nom"/>
                      <clip pos="2" side="tl" part="gen_sense_mf"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </otherwise>
            </choose>
           </when>
           <otherwise>
           <call-macro n="comparatiu_adj1">
              <with-param pos="2"/>
           </call-macro>
           <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="part_sing"/>
                  </in>
                </test>
                <out>
                  <chunk name="partnom_de_nom_adj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <lit v="de"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_nom"/>
                      <clip pos="2" side="tl" part="gen_sense_mf"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="2"/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_adj"/>
                      <clip pos="3" side="tl" part="gen_sense_mf"/>
                      <clip pos="3" side="tl" part="gen_mf"/>
                      <clip pos="3" side="tl" part="nbr_sense_sp"/>
                      <clip pos="3" side="tl" part="nbr_sp"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>
                <out>
                  <chunk name="nom_de_nom_adj" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SN"/></tag>
                      <tag><var n="genero"/></tag>
                      <tag><var n="numero"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_nom"/>
                      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                      <clip pos="1" side="tl" part="gen_mf"/>
                      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                      <clip pos="1" side="tl" part="nbr_sp"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <lit v="de"/>
                      <lit-tag v="pr"/>
                    </lu>
                    <b/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_nom"/>
                      <clip pos="2" side="tl" part="gen_sense_mf"/>
                      <clip pos="2" side="tl" part="gen_mf"/>
                      <clip pos="2" side="tl" part="nbr_sense_sp"/>
                      <clip pos="2" side="tl" part="nbr_sp"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="2"/>
                    <lu>
                      <var n="adjectiu1"/>
                      <clip pos="3" side="tl" part="lemh"/>
                      <clip pos="3" side="tl" part="a_adj"/>
                      <clip pos="3" side="tl" part="gen_sense_mf"/>
                      <clip pos="3" side="tl" part="gen_mf"/>
                      <clip pos="3" side="tl" part="nbr_sense_sp"/>
                      <clip pos="3" side="tl" part="nbr_sp"/>
                      <clip pos="3" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </otherwise>
            </choose>

           </otherwise>
         </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="nom_adj_adj" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
    <rule comment="REGLA: DET NOM ADJ DEM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>  
            <out>
              <chunk name="det_nom_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <lit v="ce"/>
                  <lit-tag v="det.dem"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="det_nom_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <lit v="ce"/>
                  <lit-tag v="det.dem"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

     <rule comment="REGLA: DET NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="plusieurs"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="pl"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <in caseless="yes">
                  <clip pos="3" side="tl" part="lem"/>
                  <list n="adj_colloc_abans"/>
                </in>
                <equal>
                  <clip pos="3" side="sl" part="grau_adj"/>
                  <lit v=""/>
                </equal>
              </and>
            </test> 
          <out>
            <chunk name="det_adj_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
        </when>
        <otherwise>
          <out>
            <chunk name="det_nom_adj" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
        </otherwise>
      </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     

     <rule comment="REGLA: DET NOM ADJ ADV">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adv"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="plusieurs"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="pl"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="3" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test> 
          <out>
            <chunk name="det_adv_adj_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
              <b pos="2"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
        </when>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <list n="adv_colloc_abans"/>
              </in>
            </test> 
          <out>
            <chunk name="det_nom_adv_adj" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lem"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
              <b pos="3"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>

            </chunk>
          </out>
        </when>

        <otherwise>
          <out>
            <chunk name="det_nom_adj_adv" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_adj"/>
                <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="3"/>
              <lu>
                <clip pos="4" side="tl" part="whole"/>
              </lu>
            </chunk>
          </out>
        </otherwise>
      </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
    <rule comment="REGLA: NOM DET NOM ADJ DEM">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="demonstrativo"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test>  
            <out>
              <chunk name="nom_de_det_nom_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <lit v="ce"/>
                  <lit-tag v="det.dem"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_adj"/>
                  <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="nom_de_det_nom_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <lit v="le"/>
                  <lit-tag v="det.def"/>
                  <clip pos="1" side="tl" part="gen_sense_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_nom"/>
                  <clip pos="1" side="tl" part="gen_sense_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="de"/>
                  <lit-tag v="pr"/>
                </lu>
                <b/>
                <lu>
                  <lit v="ce"/>
                  <lit-tag v="det.dem"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_nom"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_adj"/>
                  <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>



   <rule comment="REGLA: DET NOM NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="plusieurs"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="pl"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="4" side="tl" part="lem"/>
                <list n="adj_colloc_abans"/>
              </in>
            </test> 
          <out>
            <chunk name="det_nom_de_adj_nom" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_adj"/>
                <clip pos="4" side="tl" part="gen_sense_mf"/>
                <clip pos="4" side="tl" part="gen_mf"/>
                <clip pos="4" side="tl" part="nbr_sense_sp"/>
                <clip pos="4" side="tl" part="nbr_sp"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen_sense_mf"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
        </when>
        <otherwise>
          <out>
            <chunk name="det_nom_de_nom_adj" case="caseFirstWord">
              <tags>
                <tag><lit-tag v="SN"/></tag>
                <tag><var n="genero"/></tag>
                <tag><var n="numero"/></tag>
              </tags>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_det"/>
                <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="1" side="tl" part="gen_mf"/>
                <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="1" side="tl" part="nbr_sp"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
              <b pos="1"/>
              <lu>
                <clip pos="2" side="tl" part="lemh"/>
                <clip pos="2" side="tl" part="a_nom"/>
                <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="2" side="tl" part="gen_mf"/>
                <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="2" side="tl" part="nbr_sp"/>
                <clip pos="2" side="tl" part="lemq"/>
              </lu>
              <b/>
              <lu>
                <lit v="de"/>
                <lit-tag v="pr"/>
              </lu>
              <b/>
              <lu>
                <clip pos="3" side="tl" part="lemh"/>
                <clip pos="3" side="tl" part="a_nom"/>
                <clip pos="3" side="tl" part="gen_sense_mf"/>
                <clip pos="3" side="tl" part="gen_mf"/>
                <clip pos="3" side="tl" part="nbr_sense_sp"/>
                <clip pos="3" side="tl" part="nbr_sp"/>
                <clip pos="3" side="tl" part="lemq"/>
              </lu>
              <b pos="2"/>
              <lu>
                <var n="adjectiu1"/>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_adj"/>
                <clip pos="4" side="tl" part="gen_sense_mf"/>
                <clip pos="4" side="tl" part="gen_mf"/>
                <clip pos="4" side="tl" part="nbr_sense_sp"/>
                <clip pos="4" side="tl" part="nbr_sp"/>
                <clip pos="4" side="tl" part="lemq"/>
              </lu>
            </chunk>
          </out>
        </otherwise>
      </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: DET NUM NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="plusieurs"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="pl"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="det_num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="1" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
   <rule comment="REGLA: NOM ADJ cnjcoo ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="nom_adj_cnjcoo_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
    <rule comment="REGLA: ADJ cnjcoo ADJ">
      <pattern>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1-2">
          <with-param pos="3"/>
        </call-macro>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="nbr"/> 
                    <lit-tag v="ND"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="nbr"/> 
                  <lit-tag v="sg"/>
                </let>
              </when>
            </choose>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="3"/>
            </call-macro>
            <out>
              <chunk name="adj_cnjcoo_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <var n="adjectiu2"/>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
      </action>
   </rule>

   
    <rule comment="REGLA: ADJ ADJ">
      <pattern>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <choose>
          <when>
            <test>
              <and>
                <not>
                  <equal>
                    <clip pos="1" side="tl" part="nbr"/>
                    <lit-tag v="sp"/>
                  </equal>
                </not>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </and>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <var n="numero"/>
            </let>
          </when>
        </choose>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <clip pos="2" side="sl" part="lem"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="grau_adj"/>
                  <lit-tag v="comp"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="grau_adj"/>
                  <lit-tag v="sup"/>
                </equal>
              </and>
            </test> 
            <call-macro n="f_concord1">
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="preadv_adv" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="Adv"/>
                  </tag>
                </tags>
                <lu>
                  <lit v="de plus en plus"/>
                  <lit-tag v="preadv"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <clip pos="2" side="sl" part="lem"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="a_adj"/>
                  <clip pos="2" side="sl" part="a_adj"/>
                </equal>
              </and>
            </test> 
            <out>
              <chunk name="preadv_adj" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SA"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <lit v="très"/>
                  <lit-tag v="preadv"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="nbr"/> 
                    <lit-tag v="ND"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="nbr"/> 
                  <lit-tag v="sg"/>
                </let>
              </when>
            </choose>
            <call-macro n="f_concord2">
              <with-param pos="1"/>
              <with-param pos="2"/>
            </call-macro>
            <out>
              <chunk name="adj_adj" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SA"/>
                  </tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_adj"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
      </action>
   </rule>

   
    <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="plusieurs"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="pl"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <clip pos="4" side="sl" part="lem"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="grau_adj"/>
                  <lit-tag v="comp"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="grau_adj"/>
                  <lit-tag v="sup"/>
                </equal>
              </and>
            </test> 
            <out>
              <chunk name="det_nom_preadv_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <lit v="de plus en plus"/>
                  <lit-tag v="preadv"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="lem"/>
                  <clip pos="4" side="sl" part="lem"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="3" side="sl" part="a_adj"/>
                  <clip pos="4" side="sl" part="a_adj"/>
                </equal>
              </and>
            </test> 
            <out>
              <chunk name="det_nom_preadv_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <lit v="très"/>
                  <lit-tag v="preadv"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="nbr"/> 
                    <lit-tag v="ND"/>
                  </equal>
                </test>
                <let>
                  <clip pos="1" side="tl" part="nbr"/> 
                  <lit-tag v="sg"/>
                </let>
              </when>
            </choose>
            <out>
              <chunk name="det_nom_adj_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_adj"/>
                  <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="3" side="tl" part="gen_mf"/>
                  <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="3" side="tl" part="nbr_sp"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_adj"/>
                  <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="4" side="tl" part="gen_mf"/>
                  <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="4" side="tl" part="nbr_sp"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

   <rule comment="REGLA: DET ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="det_adj" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SA"/>
              </tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

   <rule comment="REGLA: ken ADJ all">
      <pattern>
        <pattern-item n="ken"/>
        <pattern-item n="adjec"/>
        <pattern-item n="all"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="tout_aussi_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <lit v="tout"/>
              <lit-tag v="predet.2.3"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="aussi"/>
              <lit-tag v="adv"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/> 
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/> 
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>



   <rule comment="REGLA: ADJ (quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="adjec"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="adj" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SA"/>
              </tag>
<!--
              <tag><var n="numero"/></tag>
              <tag><var n="genero"/></tag>
-->
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <var n="adjectiu1"/>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_adj"/>
              <clip pos="1" side="tl" part="gen_sense_mf"/>
<!--              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>-->
              <clip pos="1" side="tl" part="gen_mf"/> 
<!--              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>-->
              <clip pos="1" side="tl" part="nbr_sense_sp"/>
              <clip pos="1" side="tl" part="nbr_sp"/> 
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

   <rule comment="REGLA: ADJ ADV">
      <pattern>
        <pattern-item n="adjec"/>
        <pattern-item n="adv"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="comparatiu_adj1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="2" side="sl" part="lem"/>
                <list n="advmod"/>
              </in>
            </test> 
            <out>
              <chunk name="preadv_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="1" side="tl" part="gen"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/> 
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/> 
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><clip pos="1" side="tl" part="gen"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <var n="adjectiu1"/>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/> 
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/> 
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
              <b pos="1"/>
              <chunk name="adv" case="caseFirstWord">
                <tags>
                  <tag><clip pos="2" side="tl" part="a_adv"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

    
    <rule comment="REGLA: DET(quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="DET"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="gen"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
<!-- *************************************** REGLES DE SV *********************************************** -->

    <rule comment="REGLA: verb particle">
      <pattern>
        <pattern-item n="verbpart"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema_Vpart"/>
          <clip pos="1" side="sl" part="lem"/>
        </let>
        <out>
          <chunk namefrom="lema_Vpart" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="Vpart"/></tag>
              <tag><clip pos="1" side="sl" part="a_part"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="sl" part="lemh"/>
              <lit-tag v="vpart"/>
              <clip pos="1" side="sl" part="a_part"/>
              <clip pos="1" side="sl" part="lemq"/>
            </lu>
          </chunk>
<!--	  <b/> -->
        </out>
        <!-- dre m'emañ e darempred gant ar skiantoù dik ez eo unan eus an obererien bennañ. -->
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <let>
          <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
      </action>
    </rule>

<!--
    <rule comment="REGLA: VERB HAVER">
       <pattern>
        <pattern-item n="aux"/>
      </pattern>
      <action>
        <call-macro n="haber">
          <with-param pos="1"/>
        </call-macro> 
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="1"/>
            </call-macro>
	    <choose>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="1" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronaux_pp"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="aux_pp"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="sl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="pers" link-to="4"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="nbr" link-to="5"/>
                  </tag>
                </tags>
                <lu>
                  <var n="auxiliar"/>
                  <var n="etiq_aux"/>
                  <lit-tag v="pri"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <lit-tag v="pp.m.sg"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
           <choose>        
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="1" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronverb"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="verb"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="pers"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="nbr"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers" link-to="4"/>
                  <clip pos="1" side="tl" part="nbr" link-to="5"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
-->

    <rule comment="REGLA: adv VERB">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="verbpers"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="2"/>
            </call-macro>
            <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="advneg"/>
                  </in>
                </test>
                <out>
                  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                    </tags>
                    <lu>
                      <lit v="ne"/>
                      <lit-tag v="adv"/>
                    </lu>
                  </chunk>
                  <b pos="1"/>
                  <chunk name="aux_adv_pp">
                    <tags>
                      <tag>
                        <lit-tag v="SV"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="sl" part="a_verb"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="sl" part="temps"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="sl" part="pers"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="sl" part="nbr"/>
                      </tag>
                    </tags>
                    <lu>
                      <var n="auxiliar"/>
                      <var n="etiq_aux"/>
                      <lit-tag v="pri"/>
                      <clip pos="2" side="sl" part="pers"/>
                      <clip pos="2" side="sl" part="nbr"/>
                    </lu>
                    <b/>
                    <lu>
                      <get-case-from pos="1">
                        <clip pos="1" side="tl" part="lem"/>
                      </get-case-from>
                      <clip pos="1" side="tl" part="a_adv"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <lit-tag v="pp.m.sg"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>
                <choose>
                  <when>
                    <test>
                      <equal caseless="yes">
                        <clip pos="1" side="sl" part="lem"/>
                        <lit v="no"/>
                      </equal>
                    </test>
                    <out>
                      <chunk name="adv" case="caseFirstWord">
                        <tags>
                          <tag>
                            <clip pos="1" side="tl" part="a_adv"/>
                          </tag>
                        </tags>
                        <lu>
                          <clip pos="1" side="tl" part="lemh"/>
                          <clip pos="1" side="tl" part="a_adv"/>
                          <clip pos="1" side="tl" part="lemq"/>
                        </lu>
                      </chunk>
                      <b pos="1"/>
                      <chunk name="aux_adv_pp">
                        <tags>
                          <tag>
                            <lit-tag v="SV"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="a_verb"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="temps"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="pers"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="nbr"/>
                          </tag>
                        </tags>
                        <lu>
                          <var n="auxiliar"/>
                          <var n="etiq_aux"/>
                          <lit-tag v="pri"/>
                          <clip pos="2" side="sl" part="pers"/>
                          <clip pos="2" side="sl" part="nbr"/>
                        </lu>
                        <b/>
                        <lu>
                          <lit v="pas"/>
                          <lit-tag v="adv"/>
                        </lu>
                        <b/>
                        <lu>
                          <clip pos="2" side="tl" part="lemh"/>
                          <clip pos="2" side="tl" part="a_verb"/>
                          <lit-tag v="pp.m.sg"/>
                          <clip pos="2" side="tl" part="lemq"/>
                        </lu>
                      </chunk>
                    </out>
                  </when>
                  <otherwise>
                    <out>
                      <chunk name="aux_adv_pp" case="caseFirstWord">
                        <tags>
                          <tag>
                            <lit-tag v="SV"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="a_verb"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="temps"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="pers"/>
                          </tag>
                          <tag>
                            <clip pos="2" side="sl" part="nbr"/>
                          </tag>
                        </tags>
                        <lu>
                          <get-case-from pos="1">
                            <var n="auxiliar"/>
                          </get-case-from>
                          <var n="etiq_aux"/>
                          <lit-tag v="pri"/>
                          <clip pos="2" side="sl" part="pers"/>
                          <clip pos="2" side="sl" part="nbr"/>
                        </lu>
                        <b/>
                        <lu>
                          <get-case-from pos="2">
                            <clip pos="1" side="tl" part="lemh"/>
                          </get-case-from>
                          <clip pos="1" side="tl" part="a_adv"/>
                            <clip pos="1" side="tl" part="lemq"/>
                        </lu>
                        <b/>
                        <lu>
                          <clip pos="2" side="tl" part="lemh"/>
                          <clip pos="2" side="tl" part="a_verb"/>
                          <lit-tag v="pp.m.sg"/>
                          <clip pos="2" side="tl" part="lemq"/>
                        </lu>
                      </chunk>
                    </out>
                  </otherwise>
                </choose>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <choose>
              <when>
                <test>
                  <in caseless="yes">
                    <clip pos="1" side="tl" part="lem"/>
                    <list n="advneg"/>
                  </in>
                </test>
                <out>
                  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                    </tags>
                    <lu>
                      <lit v="ne"/>
                      <lit-tag v="adv"/>
                    </lu>
                  </chunk>
                  <b pos="1"/>
                  <chunk name="verb">
                    <tags>
                      <tag>
                        <lit-tag v="SV"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="tl" part="a_verb"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="tl" part="temps"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="tl" part="pers"/>
                      </tag>
                      <tag>
                        <clip pos="2" side="tl" part="nbr"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps" link-to="3"/> <!-- @@ Added linkto -->
                      <clip pos="2" side="tl" part="pers" link-to="4"/>
                      <clip pos="2" side="tl" part="nbr" link-to="5"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                  <b/>
                  <chunk name="adv">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_adv"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>
                <out>
                  <chunk name="adv" case="caseFirstWord">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_adv"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                  <b pos="1"/>
                  <chunk name="verb">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="2" side="tl" part="temps"/></tag>
                      <tag><clip pos="2" side="tl" part="pers"/></tag>
                      <tag><clip pos="2" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps" link-to="3"/>
                      <clip pos="2" side="tl" part="pers" link-to="4"/>
                      <clip pos="2" side="tl" part="nbr" link-to="5"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
                <call-macro n="envia_pas">
                  <with-param pos="1"/>
                </call-macro>
              </otherwise>
            </choose>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
       
    <rule comment="REGLA: PP">
      <pattern>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
           <test>
             <or>
             <equal>
               <var n="numero"/>
               <lit-tag v="sp"/>
             </equal>
             <equal>
               <var n="numero"/>
               <lit-tag v="ND"/>
             </equal>
             </or>
           </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
           </when>
        </choose>
        <choose>
          <when>
           <test>
             <or>
             <equal>
               <var n="genero"/>
               <lit-tag v="mf"/>
             </equal>
             <equal>
               <var n="genero"/>
               <lit-tag v="GD"/>
             </equal>
             </or>
           </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
           </when>
        </choose>
            <out>
              <chunk name="pp" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag>
                    <var n="genero"/>
                  </tag>
                  <tag>
                    <var n="numero"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <lit-tag v="pp"/>
                  <var n="genero"/>
                  <var n="numero"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
      </action>
    </rule>
    
    
    <rule comment="REGLA: adv verbcj adv → adv verbcj adv">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="verbpers"/>
        <pattern-item n="adv_neg"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="2"/>
            </call-macro>
	    <choose>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronaux_pp"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="aux_pp"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="sl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="pers" link-to="4"/>
                  </tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag>
                    <clip pos="2" side="tl" part="nbr" link-to="5"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="auxiliar"/>
                  <var n="etiq_aux"/>
                  <lit-tag v="pri"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <lit-tag v="pp.m.sg"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
           <choose>        
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronverb"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="adv_verbcj_adv"/>
                </let>
   	      </otherwise>
	    </choose>
            <choose>
              <when>
                <test>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit v=""/>
                    </equal>
                  </not>
                </test>
                <out>
                  <chunk namefrom="lema" case="caseFirstWord">
                    <tags>
                      <tag><lit-tag v="SV"/></tag>
                      <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                      <tag><clip pos="2" side="tl" part="temps"/></tag>
                      <tag><clip pos="2" side="tl" part="pers"/></tag>
                      <tag><clip pos="2" side="tl" part="gen"/></tag>
                      <tag><clip pos="2" side="tl" part="nbr"/></tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="whole"/>
                    </lu>
                    <b pos="1"/>
                    <lu>
                      <clip pos="2" side="tl" part="lemh"/>
                      <clip pos="2" side="tl" part="a_verb"/>
                      <clip pos="2" side="tl" part="temps"/>
                      <clip pos="2" side="tl" part="pers" link-to="4"/>
                      <clip pos="2" side="tl" part="nbr" link-to="6"/>
                      <clip pos="2" side="tl" part="lemq"/>
                    </lu>
                    <b pos="2"/>
                    <lu>
                      <clip pos="3" side="tl" part="whole"/>
                    </lu>
                  </chunk>
                </out>
          </when>
          <otherwise>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="pers"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="nbr"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers" link-to="4"/>
                  <clip pos="2" side="tl" part="nbr" link-to="5"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>      


          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

    
    <rule comment="REGLA: verbcj dobj → dobj verbcj">
      <pattern>
        <pattern-item n="verbpers"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="2"/>
            </call-macro>
	    <choose>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronaux_pp"/>
		</let>  
	      </when>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="1" side="tl" part="lem"/>
                      <list n="verbref_meta"/>
                    </in>
            	</test>
                <let>
                  <var n="lema"/>
                  <lit v="verbcj_ref"/>
		</let>  
	      </when>


	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="aux_pp"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="sl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="pers" link-to="4"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="nbr" link-to="5"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="auxiliar"/>
                  <var n="etiq_aux"/>
                  <lit-tag v="pri"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <lit-tag v="pp.m.sg"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
           <choose>        
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronverb"/>
		</let>  
	      </when>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="1" side="tl" part="lem"/>
                      <list n="verbref_meta"/>
                    </in>
            	</test>
                <let>
                  <var n="lema"/>
                  <lit v="verbcj_ref"/>
		</let>  
	      </when>


	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="dobj_verbcj"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="pers"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="nbr"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers" link-to="4"/>
                  <clip pos="1" side="tl" part="nbr" link-to="5"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

    
    <rule comment="REGLA: adv verbcj adv dobj → adv dobj verbcj adv">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="verbpers"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="2" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="2"/>
            </call-macro>
	    <choose>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronaux_pp"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="aux_pp"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="sl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="pers" link-to="4"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="nbr" link-to="5"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <var n="auxiliar"/>
                  <var n="etiq_aux"/>
                  <lit-tag v="pri"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <lit-tag v="pp.m.sg"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
           <choose>        
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="2" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronverb"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="adv_verbcj_adv"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="pers"/>
                  </tag>
                  <tag>
                    <clip pos="2" side="tl" part="nbr"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers" link-to="4"/>
                  <clip pos="2" side="tl" part="nbr" link-to="5"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>




    <rule comment="REGLA: adv verbpart verbcj adv → adv verbcj adv">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="verbpers"/>
        <pattern-item n="adv_neg"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="3" side="sl" part="temps"/>
                <lit-tag v="ifi"/>
              </equal>
            </test>
            <call-macro n="aux_ifi">
              <with-param pos="3"/>
            </call-macro>
	    <choose>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="3" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronaux_pp"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="aux_pp"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="sl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="pers" link-to="4"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="nbr" link-to="5"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <var n="auxiliar"/>
                  <var n="etiq_aux"/>
                  <lit-tag v="pri"/>
                  <clip pos="3" side="tl" part="pers"/>
                  <clip pos="3" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <lit-tag v="pp.m.sg"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
           <choose>        
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="3" side="sl" part="lem"/>
                      <list n="vbpron"/>
                    </in>
            	</test>
                <let>
                <var n="lema"/>
                <lit v="pronverb"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
		<var n="lema"/>
		<lit v="adv_verbcj_adv"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag>
                    <lit-tag v="SV"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="a_verb"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="temps"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="pers"/>
                  </tag>
                  <tag>
                    <clip pos="3" side="tl" part="nbr"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="pers" link-to="4"/>
                  <clip pos="3" side="tl" part="nbr" link-to="5"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    
    <rule comment="REGLA: VERB IMP">
      <pattern>
        <pattern-item n="verbimp"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><var n="cur_syn_label"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps" link-to="4"/>
                  <clip pos="1" side="tl" part="pers" link-to="5"/>
                  <clip pos="1" side="tl" part="nbr" link-to="6"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    
    <rule comment="REGLA: VERB">
      <pattern>
        <pattern-item n="verbpers"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
           <choose>        
	     <when>
		<test>   
                   <equal caseless="yes">
                      <clip pos="1" side="tl" part="lem"/>
                      <lit v="être"/>
                    </equal>
            	</test>
                <let>
                  <var n="lema"/>
                  <lit v="être"/>
		</let>  
	      </when>
	     <when>
		<test>   
                   <in caseless="yes">
                      <clip pos="1" side="tl" part="lem"/>
                      <list n="verbref_meta"/>
                    </in>
            	</test>
                <let>
                  <var n="lema"/>
                  <lit v="verbcj_ref"/>
		</let>  
	      </when>
	      <otherwise>
		<let>
                  <var n="lema"/>
                  <lit v="verbcj"/>
                </let>
   	      </otherwise>
	    </choose>
            <out>
              <chunk namefrom="lema" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><var n="cur_syn_label"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps" link-to="4"/>
                  <clip pos="1" side="tl" part="pers" link-to="5"/>
                  <clip pos="1" side="tl" part="nbr" link-to="6"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    <rule comment="REGLA: en ur + inf → en ger ">
      <pattern>
        <pattern-item n="verbpart_en_ur"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="en_ger" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="gen"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="ger"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
      
    <rule comment="REGLA: o + inf → en train de inf">
      <pattern>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="en_train_de_inf"/>
        </let>
        <choose>
          <when>
            <test>
              <equal>
                <b pos="1"/>
                <lit v=""/>
              </equal>
            </test>
            <let>
              <var n="cur_espai"/>
              <lit v=" "/>
            </let>
          </when>
          <otherwise>
            <let>
              <var n="cur_espai"/>
              <b pos="1"/>
            </let>
          </otherwise>
        </choose>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="gen"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <lit v="train"/>
              <lit-tag v="n.m.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <var n="cur_espai"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="cur_espai"/>
          <lit v=""/>
        </let>
      </action>
   </rule>
         
    <rule comment="REGLA: poent + eo → il est temps de">
      <pattern>
        <pattern-item n="instant"/>
        <pattern-item n="eo"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="être_temps_de"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser.pri.p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="temps"/>
              <lit-tag v="n.m.sp"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: poent eo da → il est temps que">
      <pattern>
        <pattern-item n="instant"/>
        <pattern-item n="eo"/>
        <pattern-item n="da"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="être_temps_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser.pri.p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="temps"/>
              <lit-tag v="n.m.sp"/>
            </lu>
            <b/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: fellout verbpart ober da indirect → prnperssubj vouloir">
      <pattern>
        <pattern-item n="fellout_inf"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="ober"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="5"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="vouloir"/>
        </let>
        <out>
          <chunk name="prnperssubj">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="5" side="tl" part="a_prn"/></tag>
              <tag><clip pos="5" side="tl" part="pers"/></tag>
              <tag><clip pos="5" side="tl" part="gen"/></tag>
              <tag><clip pos="5" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="whole"/> 
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="vouloir"/>
              <lit-tag v="vblex"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="5" side="tl" part="pers"/>
              <clip pos="5" side="tl" part="nbr"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>

    <rule comment="REGLA: fellout verbpart ober da indirect ma → prnperssubj vouloir">
      <pattern>
        <pattern-item n="fellout_inf"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="ober"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
        <pattern-item n="ma"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="5"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="vouloir_que"/>
        </let>
        <out>
          <chunk name="prnperssubj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="5" side="tl" part="a_prn"/></tag>
              <tag><clip pos="5" side="tl" part="pers"/></tag>
              <tag><clip pos="5" side="tl" part="gen"/></tag>
              <tag><clip pos="5" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="whole"/> 
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lema">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="vouloir"/>
              <lit-tag v="vblex"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="5" side="tl" part="pers"/>
              <clip pos="5" side="tl" part="nbr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="que"/> 
              <lit-tag v="cnjsub"/> 
            </lu>
          </chunk>
        </out>
      </action>
   </rule>



     <rule comment="REGLA: fellout da indirect inf → prnpersubj vouloir inf">
      <pattern>
        <pattern-item n="fellout"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="vouloir_inf"/>
        </let>
        <out>
          <chunk name="prnperssubj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="3" side="tl" part="a_prn"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="gen"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lema">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="vouloir"/>
              <lit-tag v="vblex"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
 
         
    <rule comment="REGLA: poent eo da indirect → il est temps que prnsubj">
      <pattern>
        <pattern-item n="instant"/>
        <pattern-item n="eo"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="4"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="être_temps_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser.pri.p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="temps"/>
              <lit-tag v="n.m.sp"/>
            </lu>
            <b/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="prnperssubj">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="4" side="tl" part="a_prn"/></tag>
              <tag><clip pos="4" side="tl" part="pers"/></tag>
              <tag><clip pos="4" side="tl" part="gen"/></tag>
              <tag><clip pos="4" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
          </chunk>

        </out>
      </action>
   </rule>

    <rule comment="REGLA: klask vpart ober inf → essayer de inf">
      <pattern>
        <pattern-item n="klask"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="ober"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <clip pos="4" side="tl" part="lem"/>
        </let>
        <out>
          <chunk name="essayer_de" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
              <lit v="essayer"/>
              </get-case-from>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lema">
            <tags> 
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="4" side="tl" part="a_verb"/></tag>
              <tag><clip pos="4" side="tl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         


    <rule comment="REGLA: klask inf → chercher à inf">
      <pattern>
        <pattern-item n="klask"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <clip pos="2" side="tl" part="lem"/>
        </let>
        <out>
          <chunk name="chercher_à" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b/>
            <lu>
              <lit v="à"/>
              <lit-tag v="pr"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lema">
            <tags> 
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: arabat inf → ne falloir pas inf">
      <pattern>
        <pattern-item n="arabat"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="ne_falloir_pas"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="ne"/>
              <lit-tag v="adv"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="falloir"/>
              <lit-tag v="vbmod.pri"/>
<!--              <clip pos="2" side="tl" part="temps"/> -->
              <lit-tag v="p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="pas"/>
              <lit-tag v="adv"/>
            </lu>
            <b/>
            <lu>
               <clip pos="2" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
          
    <rule comment="REGLA: ret/dav + eo → falloir que">
      <pattern>
        <pattern-item n="necesitat"/>
        <pattern-item n="eo"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="falloir"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="falloir"/>
              <lit-tag v="vbmod"/>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
        
    <rule comment="REGLA: ret/dav eo da → falloir que">
      <pattern>
        <pattern-item n="necesitat"/>
        <pattern-item n="eo"/>
        <pattern-item n="da"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="falloir_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="falloir"/>
              <lit-tag v="vbmod"/>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: ret/dav eo da iobj → falloir que prnpers">
      <pattern>
        <pattern-item n="necesitat"/>
        <pattern-item n="eo"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="4"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="falloir_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="falloir"/>
              <lit-tag v="vbmod"/>
              <clip pos="2" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="prnperssubj">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="4" side="tl" part="a_prn"/></tag>
              <tag><clip pos="4" side="tl" part="pers"/></tag>
              <tag><clip pos="4" side="tl" part="gen"/></tag>
              <tag><clip pos="4" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: ret/dav verbpart eo da iobj → falloir que prnpers">
      <pattern>
        <pattern-item n="necesitat"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="eo"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="5"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="falloir_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="falloir"/>
              <lit-tag v="vbmod"/>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="prnperssubj">
            <tags>
              <tag><lit-tag v="SN"/></tag> 
              <tag><clip pos="5" side="tl" part="a_prn"/></tag>
              <tag><clip pos="5" side="tl" part="pers"/></tag>
              <tag><clip pos="5" side="tl" part="gen"/></tag>
              <tag><clip pos="5" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         


         
    <rule comment="REGLA: e un ober → en faisant de">
      <pattern>
        <pattern-item n="e"/>
        <pattern-item n="det_indef"/>
        <pattern-item n="ober_nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="en_faisant_de"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="faire"/>
              <lit-tag v="vblex"/>
              <lit-tag v="ger"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: e un ober num → en num">
      <pattern>
        <pattern-item n="e"/>
        <pattern-item n="det_indef"/>
        <pattern-item n="ober_nom"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="en" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="PREP"/>
              </tag>
            </tags>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
         </chunk>
         <b pos="1"/>
          <chunk name="num" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
          
    <rule comment="REGLA: e un ober num nom → en num nom">
      <pattern>
        <pattern-item n="e"/>
        <pattern-item n="det_indef"/>
        <pattern-item n="ober_nom"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="f_concord2">
          <with-param pos="4"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="4" side="sl" part="nbr"/>
                <lit-tag v="pl"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <clip pos="4" side="sl" part="nbr"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="en" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="PREP"/>
              </tag>
            </tags>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
         </chunk>
         <b pos="1"/>
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
                <clip pos="4" side="tl" part="lemh"/>
                <clip pos="4" side="tl" part="a_num"/>
                <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="4" side="tl" part="gen_mf"/>
                <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="4" side="tl" part="nbr_sp"/>
                <clip pos="4" side="tl" part="lemq"/>

            </lu>
            <b pos="1"/>
            <lu>
                <clip pos="5" side="tl" part="lemh"/>
                <clip pos="5" side="tl" part="a_nom"/>
                <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
                <clip pos="5" side="tl" part="gen_mf"/>
                <clip pos="4" side="sl" part="nbr_sense_sp" link-to="3"/>
                <clip pos="5" side="tl" part="nbr_sp"/>
                <clip pos="5" side="tl" part="lemq"/>

            </lu>
          </chunk>
        </out>
      </action>
   </rule>
            

   
    <rule comment="REGLA: krog + bezañ + da + inf → commencer à inf">
      <pattern>
        <pattern-item n="krog"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="commencer_à_inf"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <lit v="commencer"/>
              <lit-tag v="vblex"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="à"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_verb"/>
              <clip pos="4" side="tl" part="temps"/>
              <clip pos="4" side="tl" part="pers"/>
              <clip pos="4" side="tl" part="nbr"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>

   
    <rule comment="REGLA: tu/tro + verbpart + bezañ → il y a moyen">
      <pattern>
        <pattern-item n="possibilitat"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="bezañ"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="y_avoir_moyen"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="y avoir"/>
              <lit-tag v="vblex"/>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="moyen"/>
              <lit-tag v="n.m.sg"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
           
         
    <rule comment="REGLA: tu/tro + verbpart + bezañ + da + indirect → il y a moyen que prnperssubj">
      <pattern>
        <pattern-item n="possibilitat"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="indirect_to_prnpers">
          <with-param pos="5"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="y_avoir_moyen_que"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
            </tags>
            <lu>
              <lit v="il"/>
              <lit-tag v="prn.tn.p3.m.sg"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="y avoir"/>
              <lit-tag v="vblex"/>
              <clip pos="3" side="tl" part="temps"/>
              <lit-tag v="p3.sg"/>
            </lu>
            <b pos="2"/>
            <lu>
              <lit v="moyen"/>
              <lit-tag v="n.m.sg"/>
            </lu>
            <b pos="3"/>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
          <b pos="4"/>
          <chunk name="prnperssubj">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="5" side="tl" part="a_prn"/></tag>
              <tag><clip pos="5" side="tl" part="pers"/></tag>
              <tag><clip pos="5" side="tl" part="gen"/></tag>
              <tag><clip pos="5" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="whole"/>
            </lu>
          </chunk>

        </out>
      </action>
   </rule>
         
    <rule comment="REGLA: a-raok inf → avant de inf">
      <pattern>
        <pattern-item n="a-raok"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="pr_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
             </tags>
             <lu>
               <lit v="avant de"/>
               <lit-tag v="pr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

       

    <rule comment="REGLA: ouzhpenn inf → en plus de inf">
      <pattern>
        <pattern-item n="ouzhpenn"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="pr_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
             </tags>
             <lu>
               <lit v="en plus de"/>
               <lit-tag v="pr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
           </chunk>
         </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


 

    <rule comment="REGLA: bezañ verbcj → verbcj">
      <pattern>
        <pattern-item n="bezañ_inf"/>
        <pattern-item n="verbpers"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="verbcj"/>
        </let>
        <choose>
          <when>
            <test>   
               <in caseless="yes">
                  <clip pos="1" side="tl" part="lem"/>
                  <list n="verbref_meta"/>
                </in>
            </test>
            <let>
              <var n="lema"/>
              <lit v="verbcj_ref"/>
            </let>  
	  </when>
        </choose>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
           
    <rule comment="REGLA: bezañ verbpart rankout inf → devoir inf">
      <pattern>
        <pattern-item n="bezañ_inf"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="rankout"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="devoir_inf"/>
        </let>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
           
    <rule comment="REGLA: o + inf + bezañ → être en train de inf">
      <pattern>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="bezañ"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="etre_en_train_de_inf"/>
        </let>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <lit v="train"/>
              <lit-tag v="n.m.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
        
    <rule comment="REGLA: o + inf + adv + bezañ → être en train de inf adv">
      <pattern>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="bezañ"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <lit v="etre_en_train_de_inf_adv"/>
        </let>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="4" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="4" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="4" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="4" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser"/>
              <clip pos="4" side="tl" part="temps"/>
              <clip pos="4" side="tl" part="pers"/>
              <clip pos="4" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <lit v="en"/>
              <lit-tag v="pr"/>
            </lu>
            <b/>
            <lu>
              <lit v="train"/>
              <lit-tag v="n.m.sg"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
        
    <rule comment="REGLA: pp bezañ o inf → être pp inf">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="aux_pp_inf" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <lit v="être"/>
              <lit-tag v="vbser"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <lit v="aller"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
        
    <rule comment="REGLA: inf dobj → dobj inf">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="dobj_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
             </tags>
             <lu>
               <clip pos="2" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


        
    <rule comment="REGLA: pp bezañ o inf dobj → être pp dobj inf">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="5"/>
        </call-macro>
        <out>
          <chunk name="aux_pp_dobj_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <lit v="être"/>
               <lit-tag v="vbser"/>
               <clip pos="2" side="tl" part="temps"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <lit v="aller"/>
               <clip pos="1" side="tl" part="a_pp"/>
               <lit-tag v="m"/>
               <var n="numero"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="5" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


        
    <rule comment="REGLA: pp bezañ o inf da iobj → être pp iobj inf">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="indirect_to_proclitic">
          <with-param pos="6"/>
        </call-macro>
        <out>
          <chunk name="aux_pp_iobj_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <lit v="être"/>
               <lit-tag v="vbser"/>
               <clip pos="2" side="tl" part="temps"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b pos="1"/>
             <lu>
               <lit v="aller"/>
               <clip pos="1" side="tl" part="a_pp"/>
               <lit-tag v="m"/>
               <var n="numero"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="6" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="4" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
        
    <rule comment="REGLA: adv bezañ adv pp o inf da iobj → adv être adv pp iobj inf">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="indirect_to_proclitic">
          <with-param pos="8"/>
        </call-macro>
        <out>
          <chunk name="adv_aux_adv_pp_iobj_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <lit v="être"/>
               <lit-tag v="vbser"/>
               <clip pos="2" side="tl" part="temps"/>
               <clip pos="2" side="tl" part="pers"/>
               <clip pos="2" side="tl" part="nbr"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <lit v="aller"/>
               <clip pos="4" side="tl" part="a_pp"/>
               <lit-tag v="m"/>
               <var n="numero"/>
             </lu>
             <b pos="4"/>
             <lu>
               <clip pos="8" side="tl" part="whole"/>
             </lu>
             <b pos="5"/>
             <lu>
               <clip pos="6" side="tl" part="lemh"/>
               <clip pos="6" side="tl" part="a_verb"/>
               <lit-tag v="inf"/>
               <clip pos="6" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>



        
    <rule comment="REGLA: pp bezañ o inf dobj iobj → inf">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="7" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <out>
              <chunk name="être_pp_dobj_iobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="4" side="tl" part="pers"/>
                  <clip pos="4" side="tl" part="nbr"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="7" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="7" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <out>
              <chunk name="être_pp_iobj_dobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="4" side="tl" part="pers"/>
                  <clip pos="4" side="tl" part="nbr"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="être_pp_dobj_verb_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="5"/> 
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

         
    <rule comment="REGLA: adv bezañ adv pp o inf dobj iobj → inf">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="7" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="9" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="9"/>
            </call-macro>
            <out>
              <chunk name="adv_être_adv_pp_dobj_iobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="9" side="tl" part="whole"/>
                </lu>
                <b pos="6"/>
                <lu>
                  <clip pos="6" side="tl" part="lemh"/>
                  <clip pos="6" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="6" side="tl" part="pers"/>
                  <clip pos="6" side="tl" part="nbr"/>
                  <clip pos="6" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="7" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="9" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="9" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="9"/>
            </call-macro>
            <out>
              <chunk name="adv_être_adv_pp_iobj_dobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="9" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="6"/>
                <lu>
                  <clip pos="6" side="tl" part="lemh"/>
                  <clip pos="6" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="6" side="tl" part="pers"/>
                  <clip pos="6" side="tl" part="nbr"/>
                  <clip pos="6" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="adv_être_adv_pp_dobj_verb_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="2" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <lit v="être"/>
                  <lit-tag v="vbser"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="aller"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="6" side="tl" part="lemh"/>
                  <clip pos="6" side="tl" part="a_verb"/>
                  <lit-tag v="inf"/>
                  <clip pos="6" side="tl" part="lemq"/>
                </lu>
                <b pos="6"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="7"/> 
                <lu>
                  <clip pos="9" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


        
    <rule comment="REGLA: bezañ o mont da inf → aller inf">
      <pattern>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="mont_inf"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="aller_verb" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_verb"/>
              <clip pos="5" side="tl" part="temps"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    <rule comment="REGLA: verbpers da inf → verbcj inf">
      <pattern>
        <pattern-item n="verbpers"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="verbcj_inf" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>




        
    <rule comment="REGLA: inf dobj iobj → inf">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="4" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <chunk name="dobj_iobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="4" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="4" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="2"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="4"/>
            </call-macro>
            <out>
              <chunk name="iobj_dobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="dobj_verb_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="3"/> 
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

        
   <rule comment="REGLA: adv aux adv pp dobj iobj → adv haver adv pp">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="aux"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="7" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <out>
              <chunk name="adv_dobj_iobj_haver_adv_pp" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="5" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="7" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="7" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="7"/>
            </call-macro>
            <out>
              <chunk name="iobj_dobj_haver_pp" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="dobj_haver_pp_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="4" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="4"/>
                <lu>
                  <clip pos="4" side="tl" part="lemh"/>
                  <clip pos="4" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="4" side="tl" part="lemq"/>
                </lu>
                <b pos="5"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="6"/> 
                <lu>
                  <clip pos="7" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


        
   <rule comment="REGLA: pp aux dobj iobj → haver pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="aux"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="5" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <out>
              <chunk name="dobj_iobj_haver_pp" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="3" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="5" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="5" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="3"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="5"/>
            </call-macro>
            <out>
              <chunk name="iobj_dobj_haver_pp" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="dobj_haver_pp_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="2" side="tl" part="temps"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="whole"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="a_verb"/>
                  <clip pos="2" side="tl" part="temps"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_pp"/>
                  <lit-tag v="m"/>
                  <var n="numero"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="4"/> 
                <lu>
                  <clip pos="5" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>



    <rule comment="REGLA: mont_inf da inf → aller inf">
      <pattern>
        <pattern-item n="mont_inf"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="inf_inf" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

        
    <rule comment="REGLA: prnperssubj bezañ o mont_inf da inf → aller inf">
      <pattern>
        <pattern-item n="prnperssubj"/>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="mont_inf"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="prnperssubj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="a_prn"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_prn"/>
               <clip pos="1" side="tl" part="tipus_prn"/>
               <clip pos="1" side="tl" part="pers" link-to="4"/>
               <clip pos="1" side="tl" part="gen" link-to="5"/>
               <clip pos="1" side="tl" part="nbr" link-to="6"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="aller_verb">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="4" side="tl" part="lemh"/>
               <clip pos="2" side="tl" part="a_verb"/>
               <clip pos="2" side="tl" part="temps"/>
               <clip pos="1" side="tl" part="pers" link-to="4"/>
               <clip pos="1" side="tl" part="nbr" link-to="5"/>
               <clip pos="4" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="6" side="tl" part="lemh"/>
               <clip pos="6" side="tl" part="a_verb"/>
               <clip pos="6" side="tl" part="temps"/>
               <clip pos="6" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

        
    <rule comment="REGLA: mont da inf → aller inf">
      <pattern>
        <pattern-item n="mont"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="aller_verb" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <clip pos="1" side="tl" part="temps"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <clip pos="3" side="tl" part="temps"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
        
    <rule comment="REGLA: adv verbpart mont adv da inf → adv aller adv inf">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="mont"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="adv_aller_adv_inf" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <clip pos="3" side="tl" part="temps"/>
               <clip pos="3" side="tl" part="pers"/>
               <clip pos="3" side="tl" part="nbr"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
             <b pos="3"/>
             <lu>
               <clip pos="6" side="tl" part="lemh"/>
               <clip pos="6" side="tl" part="a_verb"/>
               <clip pos="6" side="tl" part="temps"/>
               <clip pos="6" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

 
        
    <rule comment="REGLA: bezañ o mont da inf dobj → aller dobj inf">
      <pattern>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="mont_inf"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="6"/>
        </call-macro>
        <out>
          <chunk name="aller_dobj_verb" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <clip pos="1" side="tl" part="temps"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="6" side="tl" part="whole"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="5" side="tl" part="lemh"/>
               <clip pos="5" side="tl" part="a_verb"/>
               <clip pos="5" side="tl" part="temps"/>
               <clip pos="5" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

         
    <rule comment="REGLA: bezañ o mont da inf dobj iobj → aller inf">
      <pattern>
        <pattern-item n="bezañ"/>
        <pattern-item n="verbpart_o"/>
        <pattern-item n="mont_inf"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="6" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="8" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="6"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="8"/>
            </call-macro>
            <out>
              <chunk name="aller_dobj_iobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="8" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="5" side="tl" part="lemh"/>
                  <clip pos="5" side="tl" part="a_verb"/>
                  <clip pos="5" side="tl" part="temps"/>
                  <clip pos="5" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="6" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="8" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="8" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="6"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="8"/>
            </call-macro>
            <out>
              <chunk name="aller_iobj_dobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="8" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="5" side="tl" part="lemh"/>
                  <clip pos="5" side="tl" part="a_verb"/>
                  <clip pos="5" side="tl" part="temps"/>
                  <clip pos="5" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="aller_dobj_verb_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="5" side="tl" part="lemh"/>
                  <clip pos="5" side="tl" part="a_verb"/>
                  <clip pos="5" side="tl" part="temps"/>
                  <clip pos="5" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="4"/> 
                <lu>
                  <clip pos="8" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

 
        
    <rule comment="REGLA: mont da inf dobj → aller dobj inf">
      <pattern>
        <pattern-item n="mont"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk name="aller_dobj_verb" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <clip pos="1" side="tl" part="temps"/>
               <clip pos="1" side="tl" part="pers"/>
               <clip pos="1" side="tl" part="nbr"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
             <b pos="2"/>
             <lu>
               <clip pos="3" side="tl" part="lemh"/>
               <clip pos="3" side="tl" part="a_verb"/>
               <clip pos="3" side="tl" part="temps"/>
               <clip pos="3" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

         
    <rule comment="REGLA: mont da inf dobj iobj → aller inf">
      <pattern>
        <pattern-item n="mont"/>
        <pattern-item n="da"/>
        <pattern-item n="inf"/>
        <pattern-item n="direct"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="4" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <equal>
                  <clip pos="6" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="4"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="6"/>
            </call-macro>
            <out>
              <chunk name="aller_dobj_iobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <when>
            <test>
              <and>
                <equal>
                  <clip pos="4" side="tl" part="pers"/>
                  <lit-tag v="p3"/>
                </equal>
                <or>
                  <equal>
                    <clip pos="6" side="tl" part="pers"/>
                    <lit-tag v="p1"/>
                  </equal>
                  <equal>
                    <clip pos="6" side="tl" part="pers"/>
                    <lit-tag v="p2"/>
                  </equal>
                </or>
              </and>
            </test>
            <call-macro n="direct_to_proclitic">
              <with-param pos="4"/>
            </call-macro>
            <call-macro n="indirect_to_proclitic">
              <with-param pos="6"/>
            </call-macro>
            <out>
              <chunk name="aller_iobj_dobj_verb" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="aller_dobj_verb_iobj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="tl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="4" side="tl" part="whole"/>
                </lu>
                <b pos="2"/>
                <lu>
                  <clip pos="3" side="tl" part="lemh"/>
                  <clip pos="3" side="tl" part="a_verb"/>
                  <clip pos="3" side="tl" part="temps"/>
                  <clip pos="3" side="tl" part="lemq"/>
                </lu>
                <b pos="3"/>
                <lu>
                  <lit v="à"/>
                  <lit-tag v="pr"/>
                </lu>
                <b pos="4"/> 
                <lu>
                  <clip pos="6" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>

        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

 


   
    <rule comment="prnpro">
<!--per quan va seguit d'un verb desconegut-->
      <pattern>
        <pattern-item n="prnpro"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="pro" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="prnpro"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="tipoenc_pro"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <lit-tag v="prn.pro"/>
              <clip pos="1" side="tl" part="tipoenc_pro"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
    <rule comment="REGLA: INF">
      <pattern>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <clip pos="1" side="tl" part="lem"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="temps"/>
              </tag>
              <tag>
                <lit-tag v="sg"/>
              </tag>
<!--com a sn és sg ("cantar és important") -->
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    <rule comment="REGLA: inf verbpart ober">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="ober"/>
      </pattern>
      <action>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
	     <when>
		<test>   
                  <and>
                   <in caseless="yes">
                      <clip pos="1" side="sl" part="lem"/>
                      <list n="verbref_iv_meta"/>
                    </in>
                    <not>
                      <equal>
                        <clip pos="1" side="sl" part="transitivitat"/>
                        <lit-tag v="tv"/>
                      </equal>
                    </not>
                  </and>
            	</test>
                <let>
                  <var n="lema"/>
                  <lit v="verbcj_ref"/>
		</let>  
	      </when>
              <otherwise>
	    <let>
              <var n="lema"/>
              <lit v="verbcj"/>
            </let>
              </otherwise>
        </choose>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
<!--com a sn és sg ("cantar és important") -->
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers" link-to="4"/>
              <clip pos="3" side="tl" part="nbr" link-to="5"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
        
   <rule comment="REGLA: inf verbpart ober dobj → verbcj dobj">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="ober"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk name="dobj_verbcj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
             </tags>
             <lu>
               <clip pos="4" side="tl" part="whole"/>
             </lu>
             <b pos="1"/>
             <lu>
               <clip pos="1" side="tl" part="lemh"/>
               <clip pos="1" side="tl" part="a_verb"/>
               <clip pos="3" side="tl" part="temps"/>
               <clip pos="3" side="tl" part="pers" link-to="4"/>
               <clip pos="3" side="tl" part="nbr" link-to="5"/>
               <clip pos="1" side="tl" part="lemq"/>
             </lu>
           </chunk>
         </out>
        <call-macro n="f_bcond">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


    
  
    <rule comment="REGLA: ne INF netra → ne rien INF">
      <pattern>
        <pattern-item n="ne"/>
        <pattern-item n="inf"/>
        <pattern-item n="netra"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="adv"/>
              </tag>
            </tags>
            <lu>
              <lit v="ne"/>
              <lit-tag v="adv"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="prn">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="tipus_prn"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="gen"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_prn"/>
              <clip pos="3" side="tl" part="tipus_prn"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="inf">
            <tags>
              <tag>
                <lit-tag v="SV"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="temps"/>
              </tag>
              <tag>
                <lit-tag v="sg"/>
              </tag>
<!--com a sn és sg ("cantar és important") -->
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
        
   <rule comment="pp verbpart aux → aux pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="aux"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>

          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="tl" part="temps"/></tag>
              <tag><clip pos="3" side="tl" part="pers"/></tag>
              <!--<tag><clip pos="3" side="tl" part="gen"/></tag>-->
              <tag><var n="genero"/></tag>
              <tag><clip pos="3" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps" link-to="3"/>
              <clip pos="3" side="tl" part="pers" link-to="4"/>
              <clip pos="3" side="tl" part="nbr" link-to="6"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <lit-tag v="5.6"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
         
         
    <rule comment="pp aux → aux pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="aux"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="ND"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit v=""/>
                </equal>
              </not>
            </test>
            <let>
              <var n="genero"/>
              <clip pos="2" side="sl" part="gen"/>
            </let>
          </when>
        </choose>

        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="GD"/>
                </equal>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <!--<tag><clip pos="2" side="tl" part="gen"/></tag>-->
              <tag><var n="genero"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <!--<lit-tag v="6.7"/>-->
              <lit-tag v="m.sg"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    <rule comment="pp aux dobj → dobj aux pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="aux"/>
        <pattern-item n="direct"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="direct_to_proclitic">
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <or>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="ND"/>
                </equal>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="dobj_haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
 
   <rule comment="adv aux pp → adv aux pp // n'hon eus bet evezhiadenn ebet"> 
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag><clip pos="1" side="tl" part="a_adv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk name="haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
<!--              <tag><clip pos="2" side="tl" part="gen"/></tag> --> <!-- "n'en doa ket gwelet" Il n'avait pas vu -->
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps" link-to="3"/>
              <clip pos="2" side="tl" part="pers" link-to="4"/>
              <clip pos="2" side="tl" part="nbr" link-to="5"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


 
   <rule comment="adv aux adv pp → adv aux adv pp">
      <pattern>
        <pattern-item n="adv_neg"/>
        <pattern-item n="aux"/>
        <pattern-item n="adv_neg"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="adv_haver_adv_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="4" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
<!--              <tag><clip pos="2" side="tl" part="gen"/></tag> --> <!-- "n'en doa ket gwelet" Il n'avait pas vu -->
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps" link-to="3"/>
              <clip pos="2" side="tl" part="pers" link-to="4"/>
              <clip pos="2" side="tl" part="nbr" link-to="5"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>


   <rule comment="verbpart aux pp → aux pp">
      <pattern>
        <pattern-item n="verbpart"/>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>

        </choose>

        <out>
          <chunk name="haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="tl" part="temps"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><var n="genero"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps" link-to="4"/>
              <clip pos="2" side="tl" part="pers" link-to="5"/>
              <clip pos="2" side="tl" part="nbr" link-to="7"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_pp"/>
              <lit-tag v="6.7"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 


   <rule comment="aux pp → aux pp">
      <pattern>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
          <when>
            <test>
              <equal>
                <var n="genero"/>
                <lit-tag v="mf"/>
              </equal>
            </test>
            <let>
              <var n="genero"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="tl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><var n="genero"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps" link-to="4"/>
              <clip pos="1" side="tl" part="pers" link-to="5"/>
              <clip pos="1" side="tl" part="nbr" link-to="7"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_pp"/>
              <lit-tag v="6.7"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

 
   <rule comment="aux pp iobj → aux iobj pp">
      <pattern>
        <pattern-item n="verbpart"/>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="indirect_to_proclitic">
          <with-param pos="5"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="iobj_haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag>
                <clip pos="3" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
             <clip pos="5" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
   <rule comment="aux pp iobj → aux iobj pp">
      <pattern>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
        <pattern-item n="da"/>
        <pattern-item n="indirect"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="indirect_to_proclitic">
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="iobj_haver_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag>
                <clip pos="2" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
             <clip pos="4" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
     
    <rule comment="pp + aux + pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="haver_pp_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag>
                <clip pos="3" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="2" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
      
    <rule comment="pp + verbpart + aux + pp">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="verbpart"/>
        <pattern-item n="aux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="pih_prh_past_cip">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="vauxiliar">
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <var n="numero"/>
                <lit-tag v="sp"/>
              </equal>
            </test>
            <let>
              <var n="numero"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>

        <out>
          <chunk name="haver_pp_pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag>
                <clip pos="4" side="tl" part="a_verb"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="temps"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="pers"/>
              </tag>
              <tag>
                <clip pos="3" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_pp"/>
              <lit-tag v="m"/>
              <var n="numero"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>

      
<!--************************************ ALTRES ************************************************ -->

    <rule comment="ADV">
      <pattern>
        <pattern-item n="adv_preadv"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <in caseless="yes">
                <clip pos="1" side="tl" part="lem"/>
                <list n="advneg"/>
              </in>
            </test>
            <choose>
              <when>
                <test>
                  <equal>
                    <clip pos="1" side="tl" part="lem"/>
                    <lit v="ne"/>
                  </equal>
                </test>
                <out>
                  <chunk name="no" case="caseFirstWord">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                      <tag>
                        <clip pos="1" side="tl" part="neg"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_adv"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </when>
              <otherwise>
                <out>
                  <chunk name="adv_neg" case="caseFirstWord">
                    <tags>
                      <tag>
                        <clip pos="1" side="tl" part="a_adv"/>
                      </tag>
                      <tag>
                        <clip pos="1" side="tl" part="neg"/>
                      </tag>
                    </tags>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_adv"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </chunk>
                </out>
              </otherwise>
            </choose>
          </when>
          <otherwise>
            <out>
              <chunk name="adv" case="caseFirstWord">
                <tags>
                  <tag>
                    <clip pos="1" side="tl" part="a_adv"/>
                  </tag>
                  <tag>
                    <clip pos="1" side="tl" part="neg"/>
                  </tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adv"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="PRN personal que pot ser subjecte">
      <pattern>
        <pattern-item n="prnperssubj"/>
      </pattern>
      <action>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="prnperssubj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="5"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="6"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="PRN no personal que pot ser subjecte">
      <pattern>
        <pattern-item n="prnsubj"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="set_syn_label">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="prnsubj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="cur_syn_label"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
<!-- 				<tag><clip pos="1" side="tl" part="pers"/></tag> -->
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="4"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="5"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="PRNREF">
      <pattern>
        <pattern-item n="prnref"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="prnref" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="4"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
 
    
    <rule comment="PRNITG">
      <pattern>
        <pattern-item n="prnitg"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="prnitg" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="tipus_prn"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="gen"/>
              </tag>
	      <tag><lit-tag v="sg"/></tag>
<!--
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
-->
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="PRNREL">
      <pattern>
        <pattern-item n="rel"/>
      </pattern>
      <action>
<!--		<call-macro n="f_concord1">
				<with-param pos="1"/>
			</call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="rel" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="tipus_prn"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="gen"/>
              </tag>
              <tag>
                <clip pos="1" side="tl" part="nbr"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_prn"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
   
    <rule comment="cnjcoo">
      <pattern>
        <pattern-item n="cnjcoo"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="cnjcoo" case="caseFirstWord">
            <tags>
              <tag>
                <clip pos="1" side="tl" part="tags"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="CNJ">
      <pattern>
        <pattern-item n="cnj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <clip pos="1" side="tl" part="lem"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag><clip pos="1" side="tl" part="tags"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="PREP">
      <pattern>
        <pattern-item n="prep"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let>
          <var n="lema"/>
          <clip pos="1" side="tl" part="lem"/>
        </let>
        <out>
          <chunk namefrom="lema" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="PREP"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="NUMERAL">
      <pattern>
        <pattern-item n="numeral"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="num" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
<!--
              <tag>
                <var n="genero"/>
              </tag>
              <tag>
                <var n="numero"/>
              </tag>

            </tags>
<tags>
-->
				        <tag><clip pos="1" side="tl" part="gen"/></tag>
					<tag><clip pos="1" side="tl" part="nbr"/></tag>
			        </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="NUMERAL en cifra">
      <pattern>
        <pattern-item n="cifra"/>
      </pattern>
      <action>
        <out>
          <chunk name="cifra" case="caseFirstWord">
            <tags>
              <tag>
                <lit-tag v="SN"/>
              </tag>
              <tag>
                <lit-tag v="mf"/>
              </tag>
              <tag>
                <lit-tag v="sp"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_num"/>
              <lit-tag v="mf"/>
              <lit-tag v="sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
   </rule>
    
    <rule comment="regla: sent">
      <pattern>
        <pattern-item n="sent"/>
      </pattern>
      <action>
        <let>
          <var n="numero"/>
          <lit-tag v="sg"/>
        </let>
        <let>
          <var n="genero"/>
          <lit-tag v="m"/>
        </let>
        <choose>
          <when>
            <test>
              <not>
                <or>
                  <equal>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v=";"/>
                  </equal>
                  <equal>
                    <clip pos="1" side="sl" part="lem"/>
                    <lit v=":"/>
                  </equal>
                </or>
              </not>
            </test>
            <let>
              <var n="EOS"/>
              <lit v="true"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="punt">
            <tags>
              <tag>
                <lit-tag v="sent"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
    
    <rule>
<!-- REGLA: coma-->
      <pattern>
        <pattern-item n="coma"/>
      </pattern>
      <action>
        <out>
          <chunk name="coma">
            <tags>
              <tag>
                <lit-tag v="cm"/>
              </tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
   </rule>
    
  </section-rules>
</transfer>
